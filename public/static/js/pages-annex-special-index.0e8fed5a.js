(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-annex-special-index"],{2748:function(t,n,e){"use strict";var o=e("4ea4");e("99af"),e("4160"),e("d81d"),e("fb6a"),e("4e82"),e("a434"),e("b64b"),e("4d63"),e("ac1f"),e("25f0"),e("466d"),e("841c"),e("159b"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a,i=o(e("ade3")),u=o(e("5530")),r=o(e("fc90")),c=e("02ff"),s=e("2b53"),d=o(e("7dd6")),l=e("2f62"),g=e("6495"),f=e("b632"),h=e("d70f"),p=o(e("f722")),v=(getApp(),a={computed:(0,l.mapGetters)(["isLogin","uid"]),components:(0,u.default)({pageFooter:p.default,couponWindow:r.default},d.default)},(0,i.default)(a,"computed",(0,l.mapGetters)(["isLogin"])),(0,i.default)(a,"data",(function(){return{styleConfig:[],tempArr:[],goodType:3,loading:!1,loadend:!1,loadTitle:"下拉加载更多",page:1,limit:this.$config.LIMIT,iSshowH:!1,numConfig:0,code:"",isCouponShow:!1,couponObj:{},couponObjs:{},shareInfo:{},footConfig:{},pageId:""}})),(0,i.default)(a,"onLoad",(function(t){var n=this;t.state,t.scope;this.pageId=t.id,uni.getLocation({type:"wgs84",success:function(t){try{uni.setStorageSync("user_latitude",t.latitude),uni.setStorageSync("user_longitude",t.longitude)}catch(n){}}}),this.diyData(),this.getIndexData(),this.setOpenShare(),(0,s.getShare)().then((function(t){n.shareInfo=t.data}))})),(0,i.default)(a,"watch",{isLogin:{deep:!0,handler:function(t,n){var e=(new Date).toLocaleDateString();if(t){try{var o=uni.getStorageSync("oldDate")||""}catch(a){}o!=e&&this.getCoupon()}}}}),(0,i.default)(a,"onShow",(function(){var t=(new Date).toLocaleDateString();if(this.isLogin){try{var n=uni.getStorageSync("oldDate")||""}catch(o){}n!=t&&this.getCoupon();var e=uni.getStorageSync("oldUser")||0;e||this.getCouponOnce()}})),(0,i.default)(a,"mounted",(function(){})),(0,i.default)(a,"methods",{getCouponOnce:function(){var t=this;(0,c.getCouponNewUser)().then((function(n){t.couponObjs=n.data}))},couponCloses:function(){this.couponObjs.show=!1;try{uni.setStorageSync("oldUser",1)}catch(t){}},getCoupon:function(){var t=this;(0,c.getCouponV2)().then((function(n){t.couponObj=n.data,n.data.list.length>0&&(t.isCouponShow=!0)}))},couponClose:function(){this.isCouponShow=!1;try{uni.setStorageSync("oldDate",(new Date).toLocaleDateString())}catch(t){}},onLoadFun:function(){},getQueryString:function(t){var n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),e=new RegExp("(^|/)"+t+"/([^/]*)(/|$)","i"),o=window.location.search.substr(1).match(n),a=window.location.pathname.substr(1).match(e);return null!=o?unescape(o[2]):null!=a?unescape(a[2]):null},objToArr:function(t){var n=Object.keys(t);n.sort((function(t,n){return t-n}));var e=n.map((function(n){return t[n]}));return e},diyData:function(){var t=this,n=this;(0,c.getDiy)(this.pageId).then((function(e){if(0==e.data.length)return t.$util.Tips({title:"暂无数据"},{tab:3});uni.setNavigationBarTitle({title:e.data.title});var o=[],a=n.objToArr(e.data.value);a.forEach((function(t,e,a){"pageFoot"==t.name&&(uni.setStorageSync("pageFoot",t),n.$store.commit("FOOT_UPLOAD",t),a.splice(e,1)),"promotionList"==t.name&&(n.numConfig=t.numConfig.val,n.getGroomList()),o=a})),n.styleConfig=o}))},getIndexData:function(){},changeBarg:function(t){this.isLogin?uni.navigateTo({url:"/pages/activity/goods_bargain_details/index?id=".concat(t.id,"&bargain=").concat(this.uid)}):(0,h.toLogin)()},changeTab:function(t){this.goodType=t,this.tempArr=[],this.page=1,this.loadend=!1;var n=!0;this.getGroomList(n)},getGroomList:function(t){var n=this,e=this,o=e.goodType;return!e.loadend&&(!e.loading&&(t&&e.$set(e,"iSshowH",!0),void(0,g.getGroomList)(o,{page:e.page,limit:e.limit}).then((function(t){var o=t.data;e.$set(e,"iSshowH",!1);var a=Math.ceil(n.numConfig/n.limit),i=o.list,u=i.length<e.limit||e.page>=a,r=e.$util.SplitArray(i,e.tempArr);e.$set(e,"tempArr",r.slice(0,n.numConfig)),e.loadend=u,e.loadTitle=u?"我也是有底线的":"下拉加载更多",e.page=e.page+1,e.loading=!1})).catch((function(t){e.loading=!1,e.loadTitle="下拉加载更多"}))))},goDetail:function(t){(0,f.goShopDetail)(t,this.uid).then((function(n){uni.navigateTo({url:"/pages/goods_details/index?id=".concat(t.id)})}))},setOpenShare:function(){var t=this;t.$wechat.isWeixin()&&(0,s.getShare)().then((function(n){var e=n.data.data,o={desc:e.synopsis,title:e.title,link:location.href,imgUrl:e.img};t.$wechat.wechatEvevt(["updateAppMessageShareData","updateTimelineShareData"],o)}))}}),(0,i.default)(a,"onReachBottom",(function(){this.getGroomList()})),a);n.default=v},"27f1":function(t,n,e){"use strict";e.r(n);var o=e("2748"),a=e.n(o);for(var i in o)"default"!==i&&function(t){e.d(n,t,(function(){return o[t]}))}(i);n["default"]=a.a},5620:function(t,n,e){"use strict";var o;e.d(n,"b",(function(){return a})),e.d(n,"c",(function(){return i})),e.d(n,"a",(function(){return o}));var a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-uni-view",[t._l(t.styleConfig,(function(n,o){return e("v-uni-view",{key:o},[e(n.name,{tag:"component",attrs:{index:o,dataConfig:n,tempArr:t.tempArr,iSshowH:t.iSshowH},on:{changeBarg:function(n){arguments[0]=n=t.$handleEvent(n),t.changeBarg.apply(void 0,arguments)},changeTab:function(n){arguments[0]=n=t.$handleEvent(n),t.changeTab.apply(void 0,arguments)},detail:function(n){arguments[0]=n=t.$handleEvent(n),t.goDetail.apply(void 0,arguments)}}})],1)})),t.tempArr.length&&"promotionList"==t.styleConfig[t.styleConfig.length-1].name?e("v-uni-view",{staticClass:"loadingicon acea-row row-center-wrapper"},[e("v-uni-text",{staticClass:"loading iconfont icon-jiazai",attrs:{hidden:0==t.loading}}),t._v(t._s(t.loadTitle))],1):t._e()],2)},i=[]},"8b7a":function(t,n,e){"use strict";e.r(n);var o=e("5620"),a=e("27f1");for(var i in a)"default"!==i&&function(t){e.d(n,t,(function(){return a[t]}))}(i);var u,r=e("f0c5"),c=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"3618ab98",null,!1,o["a"],u);n["default"]=c.exports}}]);