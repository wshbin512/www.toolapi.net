(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3cd3fe64"],{"370a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"i-layout-page-header"},[r("PageHeader",{staticClass:"product_tabs",attrs:{title:"子订单列表","hidden-breadcrumb":""}})],1),r("Table",{ref:"table",staticClass:"orderData mt25",attrs:{columns:e.columns,data:e.orderList,loading:e.loading,"highlight-row":"","no-data-text":"暂无数据","no-filtered-data-text":"暂无筛选结果"},on:{"on-selection-change":e.onSelectTab,"on-select-all":e.selectAll,"on-select-all-cancel":e.selectAll,"on-select-cancel":e.onSelectCancel},scopedSlots:e._u([{key:"order_id",fn:function(t){var a=t.row;t.index;return[r("span",{staticStyle:{display:"block"},domProps:{textContent:e._s(a.order_id)}}),r("span",{directives:[{name:"show",rawName:"v-show",value:1===a.is_del,expression:"row.is_del === 1"}],staticStyle:{color:"#ed4014",display:"block"}},[e._v("用户已删除")])]}},{key:"nickname",fn:function(t){var a=t.row;t.index;return[r("a",{on:{click:function(t){return e.showUserInfo(a)}}},[e._v(e._s(a.nickname))])]}},{key:"info",fn:function(t){var a=t.row;t.index;return e._l(a._info,(function(t,a){return r("div",{key:a,staticClass:"tabBox"},[r("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"tabBox_img"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.cart_info.productInfo.attrInfo?t.cart_info.productInfo.attrInfo.image:t.cart_info.productInfo.image,expression:"\n              val.cart_info.productInfo.attrInfo\n                ? val.cart_info.productInfo.attrInfo.image\n                : val.cart_info.productInfo.image\n            "}]})]),r("span",{staticClass:"tabBox_tit"},[e._v("\n          "+e._s(t.cart_info.productInfo.store_name+" | ")+e._s(t.cart_info.productInfo.attrInfo?t.cart_info.productInfo.attrInfo.suk:"")+"\n        ")]),r("span",{staticClass:"tabBox_pice"},[e._v(e._s("￥"+t.cart_info.truePrice+" x "+t.cart_info.cart_num))])])}))}},{key:"statusName",fn:function(t){var a=t.row;t.index;return[r("div",{staticClass:"pt5",domProps:{innerHTML:e._s(a.status_name.status_name)}}),e._l(a.status_name.pics||[],(function(t,n){return a.status_name.pics?r("div",{directives:[{name:"viewer",rawName:"v-viewer"}],key:n,staticClass:"pictrue mr10"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t,expression:"item"}],attrs:{src:t}})]):e._e()}))]}},{key:"action",fn:function(t){var a=t.row;t.index;return[1===a._status?r("a",{on:{click:function(t){return e.edit(a)}}},[e._v("编辑")]):e._e(),2!==a._status&&8!==a._status||1!==a.shipping_type||null!==a.pinkStatus&&2!==a.pinkStatus?e._e():r("a",{on:{click:function(t){return e.sendOrder(a)}}},[e._v("发送货")]),4===a._status?r("a",{on:{click:function(t){return e.delivery(a)}}},[e._v("配送信息")]):e._e(),2==a.shipping_type&&0==a.status&&1==a.paid&&0===a.refund_status?r("a",{on:{click:function(t){return e.bindWrite(a)}}},[e._v("立即核销")]):e._e(),2===a._status||8===a._status?r("Divider",{attrs:{type:"vertical"}}):e._e(),8===a._status?r("a",{on:{click:function(t){return e.splitOrderDetail(a)}}},[e._v("查看子订单")]):e._e(),1===a._status||(2===a._status||8===a._status)&&(null===a.pinkStatus||2===a.pinkStatus)||4===a._status||2==a.shipping_type&&0==a.status&&1==a.paid&&0===a.refund_status?r("Divider",{attrs:{type:"vertical"}}):e._e(),[r("Dropdown",{on:{"on-click":function(t){return e.changeMenu(a,t)}}},[r("a",{attrs:{href:"javascript:void(0)"}},[e._v("\n            更多\n            "),r("Icon",{attrs:{type:"ios-arrow-down"}})],1),r("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[r("DropdownItem",{directives:[{name:"show",rawName:"v-show",value:1===a._status&&0===a.paid&&"offline"===a.pay_type,expression:"\n                row._status === 1 &&\n                row.paid === 0 &&\n                row.pay_type === 'offline'\n              "}],ref:"ones",attrs:{name:"1"}},[e._v("立即支付")]),r("DropdownItem",{attrs:{name:"2"}},[e._v("订单详情")]),r("DropdownItem",{attrs:{name:"3"}},[e._v("订单记录")]),r("DropdownItem",{directives:[{name:"show",rawName:"v-show",value:a._status>=3&&a.express_dump,expression:"row._status >= 3 && row.express_dump"}],attrs:{name:"11"}},[e._v("电子面单打印")]),r("DropdownItem",{directives:[{name:"show",rawName:"v-show",value:a._status>=2,expression:"row._status >= 2"}],attrs:{name:"10"}},[e._v("小票打印")]),r("DropdownItem",{directives:[{name:"show",rawName:"v-show",value:1!==a._status||3===a._status&&a.use_integral>0&&a.use_integral>=a.back_integral,expression:"\n                row._status !== 1 ||\n                (row._status === 3 &&\n                  row.use_integral > 0 &&\n                  row.use_integral >= row.back_integral)\n              "}],attrs:{name:"4"}},[e._v("订单备注")]),r("DropdownItem",{directives:[{name:"show",rawName:"v-show",value:3===a._status&&(parseFloat(a.pay_price)>parseFloat(a.refund_price)||0==a.pay_price&&-1!==[0,1].indexOf(a.refund_status)),expression:"\n                row._status === 3 &&\n                (parseFloat(row.pay_price) > parseFloat(row.refund_price) ||\n                  (row.pay_price == 0 &&\n                    [0, 1].indexOf(row.refund_status) !== -1))\n              "}],attrs:{name:"5"}},[e._v("立即退款")]),r("DropdownItem",{directives:[{name:"show",rawName:"v-show",value:1!==a._status&&a.use_integral>0&&a.use_integral>=a.back_integral,expression:"\n                row._status !== 1 &&\n                row.use_integral > 0 &&\n                row.use_integral >= row.back_integral\n              "}],attrs:{name:"6"}},[e._v("退积分")]),r("DropdownItem",{directives:[{name:"show",rawName:"v-show",value:3===a._status,expression:"row._status === 3"}],attrs:{name:"7"}},[e._v("不退款")]),r("DropdownItem",{directives:[{name:"show",rawName:"v-show",value:4===a._status,expression:"row._status === 4"}],attrs:{name:"8"}},[e._v("已收货")]),r("DropdownItem",{attrs:{name:"9"}},[e._v("删除订单")])],1)],1)]]}}])}),r("div",{staticClass:"acea-row row-right page"}),r("edit-from",{ref:"edits",attrs:{FromData:e.FromData},on:{submitFail:e.submitFail}}),r("user-details",{ref:"userDetails"}),r("details-from",{ref:"detailss",attrs:{orderDatalist:e.orderDatalist,orderId:e.orderId}}),r("order-remark",{ref:"remarks",attrs:{orderId:e.orderId},on:{submitFail:e.submitFail}}),r("order-record",{ref:"record"}),r("order-send",{ref:"send",attrs:{orderId:e.orderId,status:e.status},on:{submitFail:e.submitFail}})],1)},n=[],s=r("a34a"),i=r.n(s),o=r("a464"),c=r("f8b7"),l=r("2f62"),d=r("31b4"),u=r("fc48"),f=r("61f8"),h=r("417c"),p=r("d616"),m=r("a716");function g(e,t,r,a,n,s,i){try{var o=e[s](i),c=o.value}catch(l){return void r(l)}o.done?t(c):Promise.resolve(c).then(a,n)}function _(e){return function(){var t=this,r=arguments;return new Promise((function(a,n){var s=e.apply(t,r);function i(e){g(s,a,n,i,o,"next",e)}function o(e){g(s,a,n,i,o,"throw",e)}i(void 0)}))}}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(r,!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var k={name:"table_list",components:{expandRow:o["a"],editFrom:d["a"],detailsFrom:u["a"],orderRemark:f["a"],orderRecord:h["a"],orderSend:p["a"],userDetails:m["a"]},props:["where","isAll"],data:function(){var e=this;return{delfromData:{},modal:!1,orderList:[],orderCards:[],loading:!1,orderId:0,columns:[{type:"expand",width:30,render:function(e,t){return e(o["a"],{props:{row:t.row}})}},{width:50,align:"center",renderHeader:function(t,r){return t("div",{class:{"select-panel":!0},on:{mouseenter:function(t){e.display="block"},mouseleave:function(t){e.display="none"}}},[t("Checkbox",{props:{value:e.checkBox},on:{"on-change":function(t){e.checkBox=t,e.$refs.table.selectAll(e.checkBox),e.$emit("on-all",t?0:-1)}}}),t("div",{style:{position:"absolute",top:0,zIndex:2,display:e.display,width:"80px",height:"100%",padding:"0px 0",borderRadius:"4px",backgroundColor:"#fff",boxShadow:"0 0px 5px rgba(0, 0, 0, 0.2)",transform:"translateX(25%)"}},[t("div",{class:{"select-item":!0,on:0==e.isAll},style:{padding:"1px 6px",cursor:"pointer",height:"50%"},on:{click:function(t){0===e.isAll?(e.$emit("on-all",-1),e.checkBox=!1,e.$refs.table.selectAll(e.checkBox)):(e.$emit("on-all",0),e.formSelection.length||(e.checkBox=!0,e.$refs.table.selectAll(e.checkBox))),e.display="none"}}},"选择当页"),t("div",{class:{"select-item":!0,on:1==e.isAll},style:{padding:"1px 6px",cursor:"pointer",height:"50%"},on:{click:function(t){1===e.isAll?(e.isAll=-1,e.$emit("on-all",-1),e.checkBox=!1):(e.isAll=1,e.$emit("on-all",1),e.checkBox=!0),e.$refs.table.selectAll(e.checkBox),e.display="none"}}},"选择全部")])])},render:function(t,r){return t("Checkbox",{props:{value:r.row.checkBox},on:{"on-change":function(t){t?e.formSelection.push(r.row):(e.checkBox=!1,e.formSelection.forEach((function(t,a){t.id===r.row.id&&e.formSelection.splice(a,1)}))),e.$emit("on-all",e.formSelection.length?0:-1),r.row.checkBox=t,e.orderList[r.index].checkBox=t}},ref:"checkbox",refInFor:!0})}},{title:"订单号",align:"center",slot:"order_id",minWidth:150},{title:"订单类型",key:"pink_name",minWidth:120},{title:"用户信息",slot:"nickname",minWidth:100},{title:"商品信息",slot:"info",minWidth:330},{title:"实际支付",key:"pay_price",minWidth:70},{title:"支付时间",key:"_pay_time",minWidth:100},{title:"支付状态",key:"pay_type_name",minWidth:80},{title:"订单状态",key:"statusName",slot:"statusName",minWidth:100},{title:"操作",slot:"action",fixed:"right",minWidth:150,align:"center"}],page:{total:0,pageNum:1,pageSize:10},data:[],FromData:null,orderDatalist:null,modalTitleSs:"",isDelIdList:[],checkBox:!1,formSelection:[],selectionCopy:[],display:"none",autoDisabled:!1,status:0}},computed:w({},Object(l["e"])("admin/order",["orderPayType","orderStatus","orderTime","orderNum","fieldKey","orderType"])),mounted:function(){},created:function(){this.getList()},watch:{orderType:function(){this.page.pageNum=1,this.getList()},formSelection:function(e){this.$emit("order-select",e),e.length?this.$emit("auto-disabled",0):this.$emit("auto-disabled",1);var t=e.some((function(e){return 1===e.is_del}));this.getIsDel(t),this.getisDelIdListl(e)},orderList:{deep:!0,handler:function(e){var t=this;e.forEach((function(e){t.formSelection.forEach((function(t){t.id===e.id&&(e.checkBox=!0)}))}));var r=this.orderList.filter((function(e){return e.checkBox}));this.orderList.length?this.checkBox=this.orderList.length===r.length:this.checkBox=!1}}},methods:w({},Object(l["d"])("admin/order",["getIsDel","getisDelIdListl"]),{selectAll:function(e){var t=this;e.length&&(this.formSelection=e,this.selectionCopy=e),this.selectionCopy.forEach((function(e,r){e.checkBox=t.checkBox,t.$set(t.orderList,r,e)}))},showUserInfo:function(e){this.$refs.userDetails.modals=!0,this.$refs.userDetails.getDetails(e.uid)},changeMenu:function(e,t){var r=this;switch(this.orderId=e.id,t){case"1":this.delfromData={title:"修改立即支付",url:"/order/pay_offline/".concat(e.id),method:"post",ids:""},this.$modalSure(this.delfromData).then((function(e){r.$Message.success(e.msg),r.$emit("changeGetTabs"),r.getList()})).catch((function(e){r.$Message.error(e.msg)}));break;case"2":this.getData(e.id);break;case"3":this.$refs.record.modals=!0,this.$refs.record.getList(e.id);break;case"4":this.$refs.remarks.modals=!0;break;case"5":this.getRefundData(e.id);break;case"6":this.getRefundIntegral(e.id);break;case"7":this.getNoRefundData(e.id);break;case"8":this.delfromData={title:"修改确认收货",url:"/order/take/".concat(e.id),method:"put",ids:""},this.$modalSure(this.delfromData).then((function(e){r.$Message.success(e.msg),r.getList()})).catch((function(e){r.$Message.error(e.msg)}));break;case"10":this.delfromData={title:"立即打印订单",info:"您确认打印此订单吗?",url:"/order/print/".concat(e.id),method:"get",ids:""},this.$modalSure(this.delfromData).then((function(e){r.$Message.success(e.msg),r.$emit("changeGetTabs"),r.getList()})).catch((function(e){r.$Message.error(e.msg)}));break;case"11":this.delfromData={title:"立即打印电子面单",info:"您确认打印此电子面单吗?",url:"/order/order_dump/".concat(e.id),method:"get",ids:""},this.$modalSure(this.delfromData).then((function(e){r.$Message.success(e.msg),r.getList()})).catch((function(e){r.$Message.error(e.msg)}));break;default:this.delfromData={title:"删除订单",url:"/order/del/".concat(e.id),method:"DELETE",ids:""},this.delOrder(e,this.delfromData)}},submitModel:function(){this.getList()},pageChange:function(e){this.page.pageNum=e,this.getList()},limitChange:function(e){this.page.pageSize=e,this.getList()},getOrderList:function(e){Object(c["L"])(e).then((function(e){console.log(e)}))},getList:function(e){var t=this;this.page.pageNum=1===e?1:this.page.pageNum,this.loading=!0,Object(c["L"])(this.$route.query.id).then(function(){var e=_(i.a.mark((function e(r){var a;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=r.data,t.orderList=a.map((function(e){return 1===t.isAll?e.checkBox=!0:e.checkBox=!1,e})),t.orderCards=a.stat,t.page.total=a.count,t.$emit("on-changeCards",a.stat),t.loading=!1;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.loading=!1,t.$Message.error(e.msg)}))},onSelectTab:function(e){this.formSelection=e;var t=e.some((function(e){return 1===e.is_del}));this.getIsDel(t),this.getisDelIdListl(e)},edit:function(e){this.getOrderData(e.id)},splitOrderDetail:function(e){this.$router.push({path:"split_order",query:{id:e.id}})},delOrder:function(e,t){var r=this;if(1===e.is_del)this.$modalSure(t).then((function(e){r.$Message.success(e.msg),r.getList()})).catch((function(e){r.$Message.error(e.msg)}));else{var a="错误！",n="<p>您选择的的订单存在用户未删除的订单，无法删除用户未删除的订单！</p>";this.$Modal.error({title:a,content:n})}},getOrderData:function(e){var t=this;Object(c["i"])(e).then(function(){var e=_(i.a.mark((function e(r){return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!1!==r.data.status){e.next=2;break}return e.abrupt("return",t.$authLapse(r.data));case 2:t.$authLapse(r.data),t.FromData=r.data,t.$refs.edits.modals=!0;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$Message.error(e.msg)}))},getData:function(e){var t=this;Object(c["e"])(e).then(function(){var e=_(i.a.mark((function e(r){return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$refs.detailss.modals=!0,t.orderDatalist=r.data,t.orderDatalist.orderInfo.refund_reason_wap_img)try{t.orderDatalist.orderInfo.refund_reason_wap_img=JSON.parse(t.orderDatalist.orderInfo.refund_reason_wap_img)}catch(a){t.orderDatalist.orderInfo.refund_reason_wap_img=[]}case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$Message.error(e.msg)}))},submitFail:function(){this.status=0,this.getList()},getRefundData:function(e){var t=this;this.$modalForm(Object(c["l"])(e)).then((function(){t.getList(),t.$emit("changeGetTabs")}))},getRefundIntegral:function(e){var t=this;Object(c["I"])(e).then(function(){var e=_(i.a.mark((function e(r){return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.FromData=r.data,t.$refs.edits.modals=!0;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$Message.error(e.msg)}))},getNoRefundData:function(e){var t=this;this.$modalForm(Object(c["m"])(e)).then((function(){t.getList(),t.$emit("changeGetTabs")}))},sendOrder:function(e){var t=this;this.$refs.send.modals=!0,this.orderId=e.id,this.status=e._status,this.$refs.send.getList(),this.$refs.send.getDeliveryList(),this.$nextTick((function(r){t.$refs.send.getCartInfo(e._status,e.id)}))},delivery:function(e){var t=this;Object(c["f"])(e.id).then(function(){var e=_(i.a.mark((function e(r){return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.FromData=r.data,t.$refs.edits.modals=!0;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$Message.error(e.msg)}))},change:function(e){},exportData:function(){this.$refs.table.exportCsv({filename:"商品列表"})},bindWrite:function(e){var t=this;this.$Modal.confirm({title:"提示",content:"确定要核销该订单吗？",cancelText:"取消",closable:!0,maskClosable:!0,onOk:function(){Object(c["P"])(e.order_id).then((function(e){t.$Message.success(e.msg),t.getList()}))},onCancel:function(){}})},onSelectCancel:function(e,t){}})},y=k,x=(r("5c25"),r("2877")),D=Object(x["a"])(y,a,n,!1,null,"57b36150",null);t["default"]=D.exports},"5c25":function(e,t,r){"use strict";var a=r("bb67"),n=r.n(a);n.a},bb67:function(e,t,r){}}]);