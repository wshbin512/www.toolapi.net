(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c1454e4"],{7481:function(t,i,e){},da69:function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"diy-page"},[e("PageHeader",{staticClass:"product_tabs",attrs:{title:t.$route.meta.title,"hidden-breadcrumb":""}},[e("div",{attrs:{slot:"title"},slot:"title"},[e("router-link",{attrs:{to:{path:"/admin/setting/pages/special"}}},[e("Button",{staticClass:"mr20",attrs:{icon:"ios-arrow-back",size:"small"}},[t._v("返回")])],1),e("span",{staticClass:"mr20",domProps:{textContent:t._s(t.$route.meta.title)}})],1)]),e("Card",{staticClass:"ivu-mt",staticStyle:{width:"100%"},attrs:{bordered:!1,"dis-hover":""}},[e("div",{staticClass:"diy-wrapper"},[e("div",{staticClass:"left"},[e("div",{staticClass:"title-bar"},t._l(t.tabList,(function(i,n){return e("div",{key:n,staticClass:"title-item",class:{on:t.tabCur==n},on:{click:function(i){return t.bindTab(n)}}},[t._v("\n            "+t._s(i.title)+"\n          ")])})),0),0==t.tabCur?e("div",{staticClass:"wrapper"},t._l(t.leftMenu,(function(i,n){return e("div",{key:n},[e("div",{staticClass:"tips",on:{click:function(t){i.isOpen=!i.isOpen}}},[t._v("\n              "+t._s(i.title)+"\n\n              "),i.isOpen?e("Icon",{attrs:{type:"ios-arrow-down",size:"16"}}):e("Icon",{attrs:{type:"ios-arrow-forward",size:"16"}})],1),e("draggable",{staticClass:"dragArea list-group",attrs:{list:i.list,group:{name:"people",pull:"clone",put:!1},clone:t.cloneDog},on:{change:t.log}},t._l(i.list,(function(n,a){return e("div",{directives:[{name:"show",rawName:"v-show",value:i.isOpen,expression:"item.isOpen"}],key:n.id,staticClass:"list-group-item",on:{click:function(i){return t.addDom(n,a,0)}}},[e("span",{staticClass:"iconfont-diy",class:n.icon}),e("p",[t._v(t._s(n.cname))])])})),0)],1)})),0):e("div",t._l(t.urlList,(function(i,n){return e("div",{key:n,staticClass:"link-item"},[e("div",{staticClass:"name"},[t._v(t._s(i.name))]),e("div",{staticClass:"link-txt"},[t._v("地址："+t._s(i.url))]),e("div",{staticClass:"params"},[e("span",{staticClass:"txt"},[t._v("参数：")]),t._l(i.parameter,(function(i,n,a){return e("span",[t._v(t._s(n+"="+i)),e("i",{staticStyle:{"font-style":"normal"}},[t._v("&")])])}))],2),e("div",{staticClass:"lable"},[e("p",{staticClass:"txt"},[t._v("例如："+t._s(i.example))]),e("Button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:i.example,expression:"item.example",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],attrs:{size:"small"}},[t._v("复制")])],1)])})),0)]),e("div",{staticClass:"wrapper-con",staticStyle:{flex:"1",background:"#f0f2f5",display:"flex","justify-content":"center","padding-top":"45px",height:"100%"}},[e("div",{staticClass:"content"},[e("div",{staticStyle:{display:"flex","flex-direction":"column",margin:"0 24px 0",overflow:"hidden",height:"100%"}},[e("div",{staticClass:"page-title",class:{on:-100==t.activeIndex},on:{click:t.showTitle}},[t._v("\n              "+t._s(t.titleTxt)+"\n              "),e("div",{staticClass:"delete-box"}),e("div",{staticClass:"handle"})]),e("div",{staticClass:"scroll-box"},[e("draggable",{staticClass:"dragArea list-group",attrs:{list:t.mConfig,group:"people",filter:".undraggable"},on:{change:t.log}},t._l(t.mConfig,(function(i,n){return e("div",{key:n,staticClass:"mConfig-item",class:{on:t.activeIndex==n},on:{click:function(e){return t.bindconfig(i,n)}}},[e(i.name,{ref:"getComponentData",refInFor:!0,tag:"component",attrs:{configData:t.propsObj,index:n,num:i.num}}),e("div",{staticClass:"delete-box"},[e("span",{on:{click:function(e){return e.stopPropagation(),t.bindDelete(i,n)}}},[t._v("删除")])]),e("div",{staticClass:"handle"})],1)})),0)],1)])])]),e("div",{staticClass:"right-box"},t._l(t.rConfig,(function(i,n){return e("div",{key:n,staticClass:"mConfig-item"},[e("div",{staticClass:"title-bar"},[t._v(t._s(i.cname))]),e(i.configName,{tag:"component",attrs:{activeIndex:t.activeIndex,num:i.num,index:n},on:{config:t.config}})],1)})),0)])]),e("div",{staticClass:"foot-box"},[e("Button",{on:{click:t.reast}},[t._v("重置")]),e("Button",{attrs:{type:"primary",loading:t.loading},on:{click:t.saveConfig}},[t._v("保存")])],1)],1)},a=[],s=e("f478"),o=e("3335"),r=e.n(o),c=e("877c"),l=e("6980"),d=e("7736");function m(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),e.push.apply(e,n)}return e}function f(t){for(var i=1;i<arguments.length;i++){var e=null!=arguments[i]?arguments[i]:{};i%2?m(Object(e),!0).forEach((function(i){u(t,i,e[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):m(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}))}return t}function u(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}var g={name:"index.vue",components:f(f({draggable:r.a},c["a"]),l["a"]),filters:{filterTxt:function(t){if(t)return t.substr(0,t.length-1)}},computed:f({},Object(d["e"])({titleTxt:function(t){return t.admin.mobildConfig.pageTitle||"专题页"}})),data:function(){return{leftMenu:[],lConfig:[],mConfig:[],rConfig:[],activeConfigName:"",propsObj:{},activeIndex:-99,number:0,pageId:"",pageName:"",pageType:"",category:[],tabList:[{title:"组件库",key:0},{title:"页面链接",key:1}],tabCur:0,urlList:[],oldId:"",loading:!1}},created:function(){this.categoryList(),this.getUrlList(),this.pageId=this.$route.query.id,this.pageName=this.$route.query.name,this.pageType=this.$route.query.type,this.lConfig=this.objToArr(c["a"])},mounted:function(){var t=this;this.$nextTick((function(){t.arraySort(),0!=t.pageId&&t.getDefaultConfig()}))},methods:{onCopy:function(){this.$Message.success("复制成功")},onError:function(){this.$Message.error("复制失败")},getUrlList:function(){var t=this;Object(s["i"])().then((function(i){t.urlList=i.data.url}))},bindTab:function(t){this.tabCur=t},showTitle:function(){this.activeIndex=-100;var t={};for(var i in l["a"])"pageTitle"==i&&(t=l["a"][i],t.configName=l["a"][i].name,t.cname="页面设置");this.rConfig=[],this.rConfig[0]=JSON.parse(JSON.stringify(t))},objToArr:function(t){var i=Object.keys(t),e=i.map((function(i){return t[i]}));return e},log:function(t){if(t.moved&&(t.moved.oldNum=this.mConfig[t.moved.oldIndex].num,t.moved.newNum=this.mConfig[t.moved.newIndex].num,t.moved.status=t.moved.oldIndex>t.moved.newIndex,this.mConfig.forEach((function(t,i){t.num=1e3*(new Date).getTime()+i})),t.moved.list=this.mConfig,this.$store.commit("admin/mobildConfig/defaultArraySort",t.moved)),t.added){var i=t.added.element,e=1e3*(new Date).getTime();i.num=e,this.activeConfigName=i.name;var n=JSON.parse(JSON.stringify(i));n.id="id"+n.num,this.mConfig[t.added.newIndex]=n,this.rConfig=[],this.rConfig.push(n),this.mConfig.forEach((function(t,i){t.num=1e3*(new Date).getTime()+i})),t.added.list=this.mConfig,this.$store.commit("admin/mobildConfig/SETCONFIGNAME",i.name),this.$store.commit("admin/mobildConfig/defaultArraySort",t.added)}},cloneDog:function(t){return f({},t)},addDom:function(t,i,e){1;var n={},a=1e3*(new Date).getTime();t.num="".concat(a),t.id="id".concat(a),this.activeConfigName=t.name;var s=JSON.parse(JSON.stringify(t));this.rConfig=[],this.mConfig.push(s),this.rConfig.push(s),this.mConfig.forEach((function(t,i){t.num=1e3*(new Date).getTime()+i})),this.activeIndex=this.mConfig.length-1,n.element=t,n.list=this.mConfig,this.$store.commit("admin/mobildConfig/SETCONFIGNAME",t.name),this.$store.commit("admin/mobildConfig/defaultArraySort",n)},bindconfig:function(t,i){this.rConfig=[];var e=JSON.parse(JSON.stringify(t));this.rConfig.push(e),this.activeIndex=i,this.$store.commit("admin/mobildConfig/SETCONFIGNAME",t.name)},bindDelete:function(t,i){this.mConfig.splice(i,1),this.rConfig.splice(0,1),this.$store.commit("admin/mobildConfig/DELETEARRAY",t)},config:function(t){var i=this.propsObj;i.data=t,i.name=this.activeConfigName},addSort:function(t,i,e){return t[i]=t.splice(e,1,t[i])[0],t},arraySort:function(){var t=[],i={title:"基础组件",list:[],isOpen:!0},e={title:"营销组件",list:[],isOpen:!0},n={title:"工具组件",list:[],isOpen:!0};this.lConfig.map((function(t,a){0==t.type&&i.list.push(t),1==t.type&&e.list.push(t),2==t.type&&n.list.push(t)})),t.push(i,e,n),this.leftMenu=t},saveConfig:function(){var t=this;if(0==this.mConfig.length)return this.$Message.error("暂未添加任何组件，保存失败！");this.loading=!0;var i=this.$store.state.admin.mobildConfig.defaultArray;Object(s["e"])(this.pageId,{name:this.pageName,type:this.pageType,value:i,title:this.titleTxt}).then((function(i){t.loading=!1,t.pageId=i.data.id,t.$Message.success(i.msg)})).catch((function(i){t.loading=!1,t.$Message.error(i.msg)}))},getDefaultConfig:function(){var t=this;Object(s["c"])(this.pageId,{type:2}).then((function(i){var e=i.data,n={},a=[];t.$store.commit("admin/mobildConfig/titleUpdata",e.info.title);var s=t.objToArr(e.info.value);function o(t,i){return t.timestamp-i.timestamp}s.sort(o),s.map((function(i,e){i.id="id"+i.timestamp,t.lConfig.map((function(e,s){if(i.name==e.defaultName){e.num=i.timestamp,e.id="id"+i.timestamp;var o=JSON.parse(JSON.stringify(e));a.push(o),n[i.timestamp]=i,t.mConfig.push(o),t.$store.commit("admin/mobildConfig/ADDARRAY",{num:i.timestamp,val:i})}}))}))}))},categoryList:function(){var t=this;Object(s["a"])((function(i){t.category=i.data}))},reast:function(){var t=this;0==this.pageId?this.$Message.error("新增页面，无法重置"):this.$Modal.confirm({title:"提示",content:"<p>是否重置当前页面数据</p>",onOk:function(){t.mConfig=[],t.rConfig=[],t.activeIndex=-99,t.getDefaultConfig()},onCancel:function(){}})}},beforeDestroy:function(){this.$store.commit("admin/mobildConfig/titleUpdata",""),this.$store.commit("admin/mobildConfig/SETEMPTY")},destroyed:function(){this.$store.commit("admin/mobildConfig/titleUpdata",""),this.$store.commit("admin/mobildConfig/SETEMPTY")}},p=g,h=(e("fea3"),e("5d22")),v=Object(h["a"])(p,n,a,!1,null,"66824d81",null);i["default"]=v.exports},fea3:function(t,i,e){"use strict";e("7481")}}]);