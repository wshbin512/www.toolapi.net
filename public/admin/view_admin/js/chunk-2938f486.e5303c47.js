(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2938f486"],{"0105":function(t,e,s){},"0820":function(t,e,s){"use strict";var i=s("1972"),a=s.n(i);a.a},1972:function(t,e,s){},"2ba2":function(t,e,s){},"2d97":function(t,e,s){"use strict";var i=s("fce9"),a=s.n(i);a.a},"2e98":function(t,e,s){"use strict";var i=s("b1f9"),a=s.n(i);a.a},"37d1":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"kefu-layouts"},[s("div",{staticClass:"content-wrapper"},[s("baseHeader",{attrs:{kefuInfo:t.kefuInfo,online:t.online},on:{setOnline:t.setOnline,search:t.bindSearch}}),s("div",{staticClass:"container"},[s("chatList",{attrs:{userOnline:t.userOnline,newRecored:t.newRecored,searchData:t.searchData,isShow:t.isShow},on:{setDataId:t.setDataId,changeType:t.changeType}}),s("div",{staticClass:"chat-content"},[s("div",{staticClass:"chat-body"},[s("happy-scroll",{attrs:{resize:"","hide-horizontal":"","hide-vertical":"","scroll-top":t.scrollTop},on:{"vertical-start":t.scrollHandler}},[s("div",{ref:"scrollBox",staticStyle:{width:"600px",padding:"20px","margin-bottom":"20px"},attrs:{id:"chat_scroll"}},[s("Spin",{directives:[{name:"show",rawName:"v-show",value:t.isLoad,expression:"isLoad"}]},[s("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),s("div",[t._v("Loading")])],1),t._l(t.records,(function(e,i){return s("div",{key:i,staticClass:"chat-item",class:[{"right-box":e.uid==t.kefuInfo.uid},{gary:5==e.msn_type}],attrs:{id:"chat_"+e.id}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"item.show"}],staticClass:"time"},[t._v(t._s(e.time))]),s("div",{staticClass:"flex-box"},[s("div",{staticClass:"avatar"},[s("img",{attrs:{src:e.avatar,alt:""}})]),s("div",{staticClass:"msg-wrapper"},[e.msn_type<=2?[s("div",{staticClass:"txt-wrapper pad16",domProps:{innerHTML:t._s(e.msn)}})]:t._e(),3==e.msn_type?[s("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"img-wraper"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.msn,expression:"item.msn"}],attrs:{alt:""}})])]:t._e(),5==e.msn_type?[s("div",{staticClass:"order-wrapper pad16"},[s("div",{staticClass:"img-box"},[s("img",{attrs:{src:e.productInfo.image,alt:""}})]),s("div",{staticClass:"order-info"},[s("div",{staticClass:"name line1"},[t._v("\n                            "+t._s(e.productInfo.store_name)+"\n                          ")]),s("div",{staticClass:"sku"},[t._v("\n                            库存："+t._s(e.productInfo.stock)+" 销量："+t._s(e.productInfo.sales)+"\n                          ")]),s("div",{staticClass:"price-box"},[s("div",{staticClass:"num"},[t._v("\n                              ¥ "+t._s(e.productInfo.price)+"\n                            ")]),s("a",{staticClass:"more",attrs:{herf:"javascript:;"},on:{click:function(s){return s.stopPropagation(),t.lookGoods(e)}}},[t._v("查看商品 >")])])])])]:t._e(),6==e.msn_type&&(e.orderInfo.length>0||e.orderInfo.id)?[s("div",{staticClass:"order-wrapper pad16"},[s("div",{staticClass:"img-box"},[s("img",{attrs:{src:e.orderInfo.cartInfo[0].productInfo.image,alt:""}})]),s("div",{staticClass:"order-info"},[s("div",{staticClass:"name line1"},[t._v("\n                            "+t._s(e.orderInfo.order_id)+"\n                          ")]),s("div",{staticClass:"sku"},[t._v("\n                            商品数量："+t._s(e.orderInfo.total_num)+"\n                          ")]),s("div",{staticClass:"price-box"},[s("div",{staticClass:"num"},[t._v("\n                              ¥ "+t._s(e.orderInfo.pay_price)+"\n                            ")]),s("a",{staticClass:"more",attrs:{href:"javascript:;"},on:{click:function(s){return s.stopPropagation(),t.lookOrder(e)}}},[t._v("查看订单 >")])])])])]:t._e()],2)])])}))],2)])],1),s("div",{staticClass:"chat-textarea"},[s("div",{staticClass:"chat-btn-wrapper"},[s("div",{staticClass:"left-wrapper"},[s("div",{staticClass:"icon-item",on:{click:function(e){e.stopPropagation(),t.isEmoji=!t.isEmoji}}},[s("span",{staticClass:"iconfont iconbiaoqing1"})]),s("div",{staticClass:"icon-item"},[s("Upload",{attrs:{"show-upload-list":!1,headers:t.header,data:t.uploadData,"on-success":t.handleSuccess,format:["jpg","jpeg","png","gif"],"on-format-error":t.handleFormatError,action:t.upload}},[s("span",{staticClass:"iconfont icontupian1"})])],1),s("div",{staticClass:"icon-item",on:{click:function(e){e.stopPropagation(),t.isMsg=!0}}},[s("span",{staticClass:"iconfont iconliaotian"})])]),s("div",{staticClass:"right-wrapper"},[s("div",{staticClass:"icon-item",on:{click:function(e){e.stopPropagation(),t.isTransfer=!t.isTransfer}}},[s("span",{staticClass:"iconfont iconzhuanjie"}),s("span",[t._v("转接")])]),t.isTransfer?s("div",{staticClass:"transfer-box"},[s("transfer",{attrs:{userUid:t.userActive.to_uid},on:{close:t.msgClose,transferPeople:t.transferPeople}})],1):t._e(),t.isTransfer?s("div",{staticClass:"transfer-bg",on:{click:function(e){e.stopPropagation(),t.isTransfer=!1}}}):t._e()]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isEmoji,expression:"isEmoji"}],staticClass:"emoji-box"},t._l(t.emojiList,(function(e,i){return s("div",{key:i,staticClass:"emoji-item"},[s("i",{staticClass:"em",class:e,on:{click:function(s){return s.stopPropagation(),t.select(e)}}})])})),0)]),s("div",{staticClass:"textarea-box",staticStyle:{position:"relative"}},[s("Input",{ref:"textBox",staticStyle:{"font-size":"14px"},attrs:{type:"textarea",rows:4,placeholder:"请输入文字内容"},on:{"on-enter":t.bindEnter},nativeOn:{keydown:function(e){return t.listen(e)}},model:{value:t.chatCon,callback:function(e){t.chatCon=e},expression:"chatCon"}}),s("div",{staticClass:"send-btn"},[s("Button",{staticClass:"btns",attrs:{type:"primary",disabled:t.disabled},on:{click:function(e){return e.stopPropagation(),t.sendText(e)}}},[t._v("发送")])],1)],1)])]),s("div",[s("rightMenu",{attrs:{isTourist:t.tourist,uid:t.userActive.to_uid,exportOpen:t.kefuInfo.config_export_open,webType:t.userActive.type},on:{bindPush:t.bindPush}})],1)],1),s("Modal",{staticClass:"none-radius isMsgbox",attrs:{mask:!0,width:"600","mask-closable":!1,"footer-hide":!0},model:{value:t.isMsg,callback:function(e){t.isMsg=e},expression:"isMsg"}},[t.isMsg?s("msgWindow",{on:{close:t.msgClose,activeTxt:t.activeTxt}}):t._e()],1),t.isProductBox?s("div",[s("div",{staticClass:"bg",on:{click:function(e){e.stopPropagation(),t.isProductBox=!1}}}),s("goodsDetail",{attrs:{goodsId:t.goodsId}})],1):t._e(),t.isOrder?s("div",[s("Modal",{staticClass:"none-radius",attrs:{title:"订单信息",width:"700","footer-hide":!0,mask:!0},model:{value:t.isOrder,callback:function(e){t.isOrder=e},expression:"isOrder"}},[s("orderDetail",{attrs:{orderId:t.orderId}})],1)],1):t._e()],1)])},a=[],n=s("d708"),o=s("6db4"),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"base-header"},[s("div",{staticClass:"left-wrapper"},[s("Input",{staticClass:"search_box",attrs:{prefix:"ios-search",placeholder:"搜索用户名称"},on:{"on-enter":t.bindSearch,"on-change":t.inputChange}}),s("div",{staticClass:"user_info"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.kefuInfo.avatar,expression:"kefuInfo.avatar"}],attrs:{alt:""}}),s("span",[t._v(t._s(t.kefuInfo.nickname))]),s("div",{staticClass:"status-box"},[s("div",{staticClass:"status",class:t.online?"on":"off",on:{click:function(e){return e.stopPropagation(),t.setOnline(e)}}},[s("span",{staticClass:"dot"}),t._v("\n                    "+t._s(t.online?"在线":"下线")+"\n                ")]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isOnline,expression:"isOnline"}],staticClass:"online-down"},[s("div",{staticClass:"item",on:{click:function(e){return e.stopPropagation(),t.changeOnline(1)}}},[t.online?s("span",{staticClass:"iconfont iconduihao"}):t._e(),s("i",{staticClass:"green"}),t._v("在线")]),s("div",{staticClass:"item",on:{click:function(e){return e.stopPropagation(),t.changeOnline(0)}}},[t.online?t._e():s("span",{staticClass:"iconfont iconduihao"}),s("i"),t._v("下线")])])])]),s("div",{staticClass:"out-btn",on:{click:function(e){return e.stopPropagation(),t.outLogin(e)}}},[t._v("退出登录")])],1),s("div",{staticClass:"right-menu"},t._l(t.menuList,(function(e,i){return s("div",{key:i,staticClass:"menu-item",class:{on:i==t.curIndex},on:{click:function(s){return s.stopPropagation(),t.selectTab(e)}}},[t._v(t._s(e.title))])})),0)])},c=[],l=s("2f62");function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?d(s,!0).forEach((function(e){m(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function m(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var f={name:"baseHeader",props:{kefuInfo:{type:Object,default:function(){return{}}},online:{type:Boolean|Number,default:!0}},computed:u({},Object(l["e"])("admin/layout",["logoutConfirm"])),data:function(){return{menuList:[{key:0,title:"客户信息"},{key:1,title:"交易订单"},{key:2,title:"商品信息"}],curIndex:0,isOnline:!1}},mounted:function(){var t=this;document.addEventListener("click",(function(){t.isOnline=!1}))},methods:u({},Object(l["b"])("admin/account",["logout","logoutKefu"]),{selectTab:function(t){this.curIndex=t.key,this.bus.$emit("selectRightMenu",this.curIndex)},setOnline:function(){this.isOnline=!this.isOnline},changeOnline:function(t){this.$emit("setOnline",t),this.isOnline=!1},outLogin:function(){var t=this;this.$Modal.confirm({title:"退出登录确认",content:"您确定退出登录当前账户吗？打开的标签页和个人设置将会保存。",onOk:function(){t.logoutKefu({confirm:!1,vm:t})},onCancel:function(){}})},bindSearch:function(t){this.$emit("search",t.target.value)},inputChange:function(t){this.bus.$emit("change",t.target.value)}})},h=f,p=(s("b2d4"),s("2877")),v=Object(p["a"])(h,r,c,!1,null,"78091172",null),g=v.exports,_=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chatList"},[s("div",{staticClass:"tab-head"},t._l(t.hdTab,(function(e,i){return s("div",{key:i,staticClass:"item",class:{active:e.key==t.hdTabCur},on:{click:function(s){return t.changeTab(e)}}},[t._v(t._s(e.title))])})),0),s("div",{staticClass:"scroll-box"},[t.userList.length>0?s("vue-scroll",{attrs:{ops:t.ops},on:{"handle-scroll":t.handleScroll}},t._l(t.userList,(function(e,i){return s("div",{key:i,staticClass:"chat-item",class:{active:t.curId==e.id},on:{click:function(s){return t.selectUser(e)}}},[s("div",{staticClass:"avatar"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.avatar,expression:"item.avatar"}],attrs:{alt:""}}),s("div",{staticClass:"status",class:{off:0==e.online}})]),s("div",{staticClass:"user-info"},[s("div",{staticClass:"hd"},[s("span",{staticClass:"name line1"},[t._v(t._s(e.nickname))]),2==e.type?[s("span",{staticClass:"label"},[t._v("小程序")])]:t._e(),3==e.type?[s("span",{staticClass:"label H5"},[t._v("H5")])]:t._e(),1==e.type?[s("span",{staticClass:"label wechat"},[t._v("公众号")])]:t._e(),0==e.type?[s("span",{staticClass:"label pc"},[t._v("PC端")])]:t._e()],2),s("div",{staticClass:"bd line1"},[e.message_type<=2?[t._v(t._s(e.message))]:t._e(),3==e.message_type?[t._v("[图片]")]:t._e(),5==e.message_type?[t._v("[商品]")]:t._e(),6==e.message_type?[t._v("[订单]")]:t._e()],2)]),s("div",{staticClass:"right-box"},[s("div",{staticClass:"time"},[t._v(t._s(t._f("toDay")(e.update_time)))]),s("div",{staticClass:"num"},[s("Badge",{attrs:{count:e.mssage_num}},[s("a",{staticClass:"demo-badge",attrs:{href:"#"}})])],1)])])})),0):s("empty",{attrs:{msg:"暂无用户列表",status:"1"}})],1)])},b=[],C=s("49ea"),y=s("5a0c"),k=s.n(y),I=s("42e3"),w=s("8b1f"),x={name:"chatList",props:{userOnline:{type:Object,default:function(){return{}}},newRecored:{type:Object,default:function(){return{}}},searchData:{type:String,default:""},isShow:{type:Boolean,default:!1}},components:{HappyScroll:o["HappyScroll"],empty:w["a"]},watch:{userOnline:{handler:function(t,e){var s=this;t.hasOwnProperty("to_uid")&&this.userList.forEach((function(e,i){e.to_uid==t.to_uid&&(e.online=t.online,1==t.online&&s.$Notice.info({title:"上线通知",desc:"".concat(e.nickname,"上线")}))}))},deep:!0},searchData:{handler:function(t,e){t!=e&&(this.nickname=t,this.page=1,this.isScroll=!0,this.userList=[],this.isSearch=!0,this.getList())},deep:!0},isShow:{handler:function(t,e){t&&this.wsStart()},deep:!0}},data:function(){return{hdTabCur:0,hdTab:[{key:0,title:"用户列表"},{key:1,title:"游客列表"}],userList:[],curId:"",page:1,limit:15,isScroll:!0,nickname:"",isSearch:!1,ops:{vuescroll:{mode:"native",enable:!1,tips:{deactive:"Push to Load",active:"Release to Load",start:"Loading...",beforeDeactive:"Load Successfully!"},auto:!1,autoLoadDistance:0,pullRefresh:{enable:!1},pushLoad:{enable:!0,auto:!0,autoLoadDistance:10}},bar:{background:"#393232",opacity:".5",size:"5px"}}}},filters:{toDay:function(t){return t?k.a.unix(t).format("M月D日 HH:mm"):""}},mounted:function(){var t=this;this.bus.$on("change",(function(e){t.nickname=e})),this.getList()},methods:{wsStart:function(){var t=this,e=this;this.bus.pageWs.then((function(s){s.$on("transfer",(function(s){var i=!1;e.userList.forEach((function(a,n,o){if(s.recored.id==a.id){if(i=!0,s.recored.is_tourist==e.hdTabCur){var r=s.recored;o.splice(n,1),0==n&&(t.$emit("setDataId",r),r.mssage_num=0),o.unshift(r)}t.$Notice.info({title:"您有一条转接消息！"})}})),i||s.recored.is_tourist==t.hdTabCur&&t.userList.unshift(s.recored)})),s.$on("mssage_num",(function(s){if(s.recored.id){var i=!1;e.userList.forEach((function(t,a,n){if(s.recored.id==t.id&&(i=!0,s.recored.is_tourist==e.hdTabCur)){var o=s.recored;n.splice(a,1),n.unshift(o)}})),i||s.recored.is_tourist==t.hdTabCur&&t.userList.unshift(s.recored)}s.recored.is_tourist!=t.hdTabCur&&s.recored.id&&t.$Notice.info({title:t.hdTabCur?"用户发来消息啦！":"游客发来消息啦！"})}))}))},changeTab:function(t){this.hdTabCur!=t.key&&(this.hdTabCur=t.key,this.isScroll=!0,this.page=1,this.userList=[],this.$emit("changeType",t.key),this.getList())},getList:function(){var t=this;this.isScroll&&Object(I["F"])({nickname:this.nickname,page:this.page,limit:this.limit,is_tourist:this.hdTabCur}).then((function(e){e.data.length>0?(e.data[0].mssage_num=0,t.isScroll=e.data.length>=t.limit,t.userList=t.userList.concat(e.data),1==t.page&&e.data.length>0&&!t.isSearch&&(t.curId=e.data[0].id,t.$emit("setDataId",e.data[0])),t.page++):t.$emit("setDataId",0)}))},chartReachBottom:function(){this.getList()},selectUser:function(t){this.curId!=t.id&&(t.mssage_num=0,this.curId=t.id,this.$emit("setDataId",t))},handleScroll:function(t,e,s){1==t.process&&this.getList()}}},S=x,O=(s("3b7a"),Object(p["a"])(S,_,b,!1,null,"7842d0f2",null)),L=O.exports,T=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"right-wrapper"},[0==t.curStatus?[t.activeUserInfo?s("div",{staticClass:"user-wrapper"},[s("div",{staticClass:"user"},[s("div",{staticClass:"avatar"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.activeUserInfo.avatar,expression:"activeUserInfo.avatar"}],attrs:{alt:""}})]),s("div",{staticClass:"name line1"},[t._v(t._s(t.activeUserInfo.nickname))]),s("div",{staticClass:"label"},[2==t.webType?[s("span",{staticClass:"label routine"},[t._v("小程序")])]:t._e(),3==t.webType?[s("span",{staticClass:"label H5"},[t._v("H5")])]:t._e(),1==t.webType?[s("span",{staticClass:"label wechat"},[t._v("公众号")])]:t._e(),0==t.webType?[s("span",{staticClass:"label pc"},[t._v("PC端")])]:t._e()],2)]),s("div",{staticClass:"user-info"},[s("div",{staticClass:"item"},[s("span",[t._v("手机号")]),t._v("\n          "+t._s(t.activeUserInfo.phone||"暂无")+"\n        ")]),s("div",{staticClass:"item"},[s("span",[t._v("分组")]),s("Select",{staticStyle:{flex:"1"},attrs:{size:"small"},on:{"on-change":t.onChange},model:{value:t.activeUserInfo.group_id,callback:function(e){t.$set(t.activeUserInfo,"group_id",e)},expression:"activeUserInfo.group_id"}},t._l(t.userGroup,(function(e){return s("Option",{key:e.value,attrs:{value:e.id}},[t._v(t._s(e.group_name))])})),1)],1),s("div",{staticClass:"label-list",on:{click:function(e){e.stopPropagation(),t.isUserLabel=!0}}},[s("span",[t._v("用户标签")]),s("div",{staticClass:"con"},t._l(t.activeUserInfo.labelNames,(function(e){return s("div",{staticClass:"label-item"},[t._v("\n              "+t._s(e)+"\n            ")])})),0),s("div",{staticClass:"right-icon"},[s("Icon",{attrs:{type:"ios-arrow-forward",size:"14"}})],1)])]),s("div",{staticClass:"user-info"},[s("div",{staticClass:"item"},[s("span",[t._v("会员等级")]),t._v("\n          "+t._s(t.activeUserInfo.level_name)+"\n        ")]),s("div",{staticClass:"item"},[s("span",[t._v("推荐人")]),t._v("\n          "+t._s(t.activeUserInfo.spread_name)+"\n        ")]),s("div",{staticClass:"item"},[s("span",[t._v("用户类型")]),t._v("\n          "+t._s(t._f("typeFilters")(t.activeUserInfo.user_type))+"\n        ")]),s("div",{staticClass:"item"},[s("span",[t._v("余额")]),t._v("\n          "+t._s(t.activeUserInfo.now_money)+"\n        ")]),s("div",{staticClass:"item"},[s("span",[t._v("推广员")]),t._v(t._s(t.activeUserInfo.is_promoter?"是":"否")+"\n        ")]),s("div",{staticClass:"item"},[s("span",[t._v("生日")]),t._v("\n          "+t._s(t._f("getDay")(t.activeUserInfo.birthday))+"\n        ")])])]):s("empty",{attrs:{status:"2",msg:"暂无用户信息"}})]:t._e(),1==t.curStatus?[s("div",{staticClass:"order-wrapper"},[s("div",{staticClass:"tab-head"},t._l(t.menuList,(function(e,i){return s("div",{key:i,staticClass:"tab-item",class:{active:t.orderConfig.type===e.key},on:{click:function(s){return s.stopPropagation(),t.bindTab(e)}}},[t._v("\n          "+t._s(e.title)+"\n        ")])})),0),s("div",{staticClass:"search-box"},[s("Input",{staticClass:"search_box",attrs:{prefix:"ios-search",placeholder:"搜索订单编号"},on:{"on-enter":t.orderSearch},model:{value:t.orderConfig.searchTxt,callback:function(e){t.$set(t.orderConfig,"searchTxt",e)},expression:"orderConfig.searchTxt"}})],1),t.orderList.length>0?s("div",[s("Scroll",{staticClass:"right-scroll",attrs:{"on-reach-bottom":t.orderReachBottom,height:"650"}},[s("div",{staticClass:"order-list"},t._l(t.orderList,(function(e,i){return s("div",{key:i,staticClass:"order-item"},[s("div",{staticClass:"head"},[s("div",{staticClass:"left"},[s("div",{staticClass:"font-box"},[1==e.status?s("span",{staticClass:"iconfont icondaishouhuo"}):t._e(),0==e.status?s("span",{staticClass:"iconfont icondaifahuo"}):t._e(),2==e.status?s("span",{staticClass:"iconfont icondaipingjia"}):t._e(),e.status<0?s("span",{staticClass:"iconfont iconshouhou-tuikuan"}):t._e()]),t._v("\n                  "+t._s(e._status._title)+"\n                ")]),s("div",{staticClass:"time"},[t._v(t._s(e._pay_time))])]),s("div",{staticClass:"goods-list",class:{auto:!t.isOrderHidden}},t._l(e.cartInfo,(function(e){return s("div",{key:e.id,staticClass:"goods-item"},[s("div",{staticClass:"img-box"},[s("img",{attrs:{src:e.productInfo.image,alt:""}})]),s("div",{staticClass:"info"},[s("div",{staticClass:"name line1"},[t._v("\n                      "+t._s(e.productInfo.store_name)+"\n                    ")]),s("div",{staticClass:"sku"},[t._v("\n                      "+t._s(e.productInfo.attrInfo.suk)+"\n                    ")]),s("div",{staticClass:"price"},[t._v("\n                      ¥"+t._s(e.productInfo.price)+" x "+t._s(e.cart_num)+"\n                    ")])])])})),0),e.cartInfo.length>2?s("div",{staticClass:"more-box",on:{click:function(e){e.stopPropagation(),t.isOrderHidden=!t.isOrderHidden}}},[s("span",[t._v(t._s(t.isOrderHidden?"展开":"合上"))])]):t._e(),s("div",{staticClass:"order-info"},[s("div",{staticClass:"info-item"},[s("span",[t._v("订单编号：")]),t._v(t._s(e.order_id)+"\n                ")]),s("div",{staticClass:"info-item"},[s("span",[t._v("付款时间：")]),t._v("2020-09-09 15:36:34\n                ")]),s("div",{staticClass:"info-item"},[s("span",[t._v("邮费：")]),t._v("¥ "+t._s(e.pay_postage)+"\n                ")]),s("div",{staticClass:"info-item"},[s("span",[t._v("实收款：")]),t._v("¥ "+t._s(e.pay_price)+"\n                ")])]),s("div",{staticClass:"btn-wrapper"},[2===e.shipping_type||1!=e._status._type||null!==e.pinkStatus&&2!==e.pinkStatus||0==e._status._type?t._e():s("Button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(s){return s.stopPropagation(),t.openDelivery(e)}}},[t._v("发货")]),0!=e._status._type?s("Button",{staticClass:"btn",staticStyle:{color:"#1890ff","border-color":"#1890ff"},attrs:{type:"info",ghost:""},on:{click:function(s){return s.stopPropagation(),t.orderRecord(e.id)}}},[t._v("退款")]):t._e(),0==e._status._type?s("Button",{staticClass:"btn",staticStyle:{color:"#1890ff","border-color":"#1890ff"},attrs:{type:"info",ghost:""},on:{click:function(s){return s.stopPropagation(),t.orderEdit(e.id)}}},[t._v("改价")]):t._e(),s("Button",{staticClass:"btn",staticStyle:{color:"#1890ff","border-color":"#1890ff"},attrs:{type:"info",ghost:""},on:{click:function(s){return s.stopPropagation(),t.bindRemark(e)}}},[t._v("备注")])],1)])})),0)])],1):t._e(),0==t.orderList.length&&""===t.orderConfig.type?s("empty",{attrs:{status:"3",msg:"暂无订单信息"}}):t._e(),0==t.orderList.length&&0===t.orderConfig.type?s("empty",{attrs:{status:"4",msg:"暂无未支付订单"}}):t._e(),0==t.orderList.length&&1==t.orderConfig.type?s("empty",{attrs:{status:"5",msg:"暂无未发货订单"}}):t._e(),0==t.orderList.length&&-1==t.orderConfig.type?s("empty",{attrs:{status:"6",msg:"暂无退款订单"}}):t._e()],1)]:t._e(),2==t.curStatus?[s("div",{staticClass:"goods-wrapper"},[s("div",{staticClass:"goods-tab"},t._l(t.goodsTab,(function(e,i){return s("div",{key:i,staticClass:"tab-item",class:{active:t.goodsConfig.type===e.key},on:{click:function(s){return s.stopPropagation(),t.bindGoodsTab(e)}}},[t._v("\n          "+t._s(e.title)+"\n        ")])})),0),s("div",{staticClass:"search-box"},[s("Input",{staticClass:"search_box",attrs:{prefix:"ios-search",placeholder:"搜索商品名称/ID"},on:{"on-enter":t.productSearch},model:{value:t.storeName,callback:function(e){t.storeName=e},expression:"storeName"}})],1),t.goodsConfig.buyList.length>0?s("div",{staticClass:"list-wrapper"},[s("Scroll",{staticClass:"right-scroll",attrs:{height:"650"}},t._l(t.goodsConfig.buyList,(function(e){return s("div",{staticClass:"list-item"},[s("div",{staticClass:"img-box"},[s("img",{attrs:{src:e.image,alt:""}})]),s("div",{staticClass:"info"},[s("div",{staticClass:"name line1"},[t._v(t._s(e.store_name))]),s("div",{staticClass:"sku"},[s("span",[t._v("库存："+t._s(e.stock))]),s("span",[t._v("销量："+t._s(e.sales))])]),s("div",{staticClass:"price"},[s("span",[t._v("¥"+t._s(e.price))]),s("div",{staticClass:"push",on:{click:function(s){return s.stopPropagation(),t.pushGoods(e)}}},[t._v("推送")])])])])})),0)],1):s("empty",{attrs:{status:"3",msg:"暂无商品信息"}})],1)]:t._e(),s("Modal",{attrs:{title:"订单发送货","footer-hide":!0},model:{value:t.isDelivery,callback:function(e){t.isDelivery=e},expression:"isDelivery"}},[t.isDelivery?s("delivery",{attrs:{exportOpen:t.exportOpen,orderId:t.orderId},on:{close:t.deliveryClose,ok:t.deliveryOk}}):t._e()],1),s("Modal",{staticClass:"none-radius",attrs:{title:"请修改内容","footer-hide":!0,mask:!0,width:"520",closable:!1},model:{value:t.isRemarks,callback:function(e){t.isRemarks=e},expression:"isRemarks"}},[t.isRemarks?s("remarks",{attrs:{remarkId:t.remarkId},on:{close:t.deliveryClose,remarkSuccess:t.remarkSuccess}}):t._e()],1),s("Modal",{staticClass:"label-box",attrs:{"footer-hide":!0,width:"320",closable:!1,mask:!0},model:{value:t.isUserLabel,callback:function(e){t.isUserLabel=e},expression:"isUserLabel"}},[s("p",{staticClass:"label-head",attrs:{slot:"header"},slot:"header"},[s("span",[t._v("选择用户标签")])]),t.isUserLabel?s("userLabel",{attrs:{uid:t.uid},on:{close:t.deliveryClose,editLabel:t.editLabel}}):t._e()],1)],2)},M=[],j=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleInline,inline:""}},[s("FormItem",{staticClass:"form-item",attrs:{label:"选择类型：","label-position":"right","label-width":100}},[s("RadioGroup",{model:{value:t.formValidate.gender,callback:function(e){t.$set(t.formValidate,"gender",e)},expression:"formValidate.gender"}},t._l(t.radioList,(function(e,i){return s("Radio",{key:i,attrs:{label:e.key}},[t._v(t._s(e.title))])})),1)],1),1==t.formValidate.gender&&"0"!==t.exportOpen?s("FormItem",{key:"test0",staticClass:"form-item",attrs:{label:"发货类型：","label-position":"right","label-width":100}},[s("RadioGroup",{model:{value:t.formValidate.shipStatus,callback:function(e){t.$set(t.formValidate,"shipStatus",e)},expression:"formValidate.shipStatus"}},t._l(t.shipType,(function(e,i){return s("Radio",{key:i,attrs:{label:e.key}},[t._v(t._s(e.title))])})),1)],1):t._e(),1==t.formValidate.gender&&1==t.formValidate.shipStatus?s("div",{key:"test1"},[s("FormItem",{staticClass:"form-item",attrs:{label:"快递公司：",prop:"logisticsCode","label-position":"right","label-width":100}},[s("Select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择","label-in-value":!0},on:{"on-change":t.bindChange},model:{value:t.formValidate.logisticsCode,callback:function(e){t.$set(t.formValidate,"logisticsCode",e)},expression:"formValidate.logisticsCode"}},t._l(t.logisticsList,(function(e,i){return s("Option",{key:i,attrs:{value:e.code}},[t._v(t._s(e.value))])})),1)],1),s("FormItem",{staticClass:"form-item",attrs:{label:"快递单号：",prop:"number","label-position":"right","label-width":100}},[s("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入快递单号"},model:{value:t.formValidate.number,callback:function(e){t.$set(t.formValidate,"number",e)},expression:"formValidate.number"}}),"shunfeng"==t.formValidate.logisticsCode?s("div",{staticClass:"trip"},[t._v("顺丰请输入单号 : 收件人或寄件人手机号后四位")]):t._e(),"shunfeng"==t.formValidate.logisticsCode?s("div",{staticClass:"trip"},[t._v("例如：SF000000000000:3941")]):t._e()],1)],1):t._e(),1==t.formValidate.gender&&2==t.formValidate.shipStatus?s("div",{key:"test2"},[s("FormItem",{staticClass:"form-item",attrs:{label:"快递公司：",prop:"logisticsCode","label-position":"right","label-width":100}},[s("Select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",filterable:"","label-in-value":!0},on:{"on-change":t.bindChange},model:{value:t.formValidate.logisticsCode,callback:function(e){t.$set(t.formValidate,"logisticsCode",e)},expression:"formValidate.logisticsCode"}},t._l(t.logisticsList,(function(e,i){return s("Option",{key:i,attrs:{value:e.code}},[t._v(t._s(e.value))])})),1)],1),t.orderTempList.length>0?s("FormItem",{staticClass:"form-item",attrs:{label:"电子面单：","label-position":"right","label-width":100}},[s("Select",{staticStyle:{width:"80%"},attrs:{placeholder:"请选择电子面单"},model:{value:t.formValidate.electronic,callback:function(e){t.$set(t.formValidate,"electronic",e)},expression:"formValidate.electronic"}},t._l(t.orderTempList,(function(e,i){return s("Option",{attrs:{value:e.temp_id}},[t._v(t._s(e.title))])})),1),s("Button",{staticStyle:{flex:"1","margin-left":"21px"},on:{click:t.lookImg}},[t._v("预览")]),s("viewer",{ref:"viewer",staticClass:"viewer",staticStyle:{display:"none"},attrs:{images:t.orderTempList},on:{inited:t.inited}},t._l(t.orderTempList,(function(t){return s("img",{key:t.id,staticClass:"image",attrs:{src:t.pic}})})),0)],1):t._e(),s("FormItem",{staticClass:"form-item",attrs:{label:"寄件人姓名：",prop:"sendName","label-position":"right","label-width":100}},[s("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入寄件人姓名"},model:{value:t.formValidate.sendName,callback:function(e){t.$set(t.formValidate,"sendName",e)},expression:"formValidate.sendName"}})],1),s("FormItem",{staticClass:"form-item",attrs:{label:"寄件人电话：",prop:"sendPhone","label-position":"right","label-width":100}},[s("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入寄件人电话"},model:{value:t.formValidate.sendPhone,callback:function(e){t.$set(t.formValidate,"sendPhone",e)},expression:"formValidate.sendPhone"}})],1),s("FormItem",{staticClass:"form-item",attrs:{label:"寄件人地址：",prop:"sendAddress","label-position":"right","label-width":100}},[s("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入寄件人地址"},model:{value:t.formValidate.sendAddress,callback:function(e){t.$set(t.formValidate,"sendAddress",e)},expression:"formValidate.sendAddress"}})],1)],1):t._e(),2==t.formValidate.gender?s("div",{key:"test3"},[s("FormItem",{staticClass:"form-item",attrs:{label:"选择送货人：","label-position":"right","label-width":100}},[s("Select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择送货人"},model:{value:t.formValidate.postPeople,callback:function(e){t.$set(t.formValidate,"postPeople",e)},expression:"formValidate.postPeople"}},t._l(t.deliveryList,(function(e,i){return s("Option",{key:i,attrs:{value:e.id}},[t._v(t._s(e.nickname))])})),1)],1)],1):t._e(),3==t.formValidate.gender?s("div",[s("FormItem",{staticClass:"form-item",attrs:{label:"备注：",props:"msg","label-position":"right","label-width":100}},[s("Input",{attrs:{placeholder:"备注"},model:{value:t.formValidate.msg,callback:function(e){t.$set(t.formValidate,"msg",e)},expression:"formValidate.msg"}})],1)],1):t._e(),s("div",{staticClass:"mask-footer"},[s("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("提交")]),s("Button",{on:{click:t.close}},[t._v("取消")])],1)],1)],1)},E=[],P={name:"delivery",props:{isShow:{type:Boolean,default:!1},orderId:{type:String|Number,default:""},exportOpen:{type:String,default:"0"}},watch:{"formValidate.shipStatus":{handler:function(t,e){var s=this;1==t&&this.getOrderExport(""),2!=t||this.formValidate.sendName||(Object(I["m"])().then((function(t){s.formValidate.sendName=t.data.to_name,s.formValidate.sendPhone=t.data.to_tel,s.formValidate.sendAddress=t.data.to_add})),this.getOrderExport(1)),this.$refs["formValidate"].resetFields()},deep:!0},"formValidate.gender":{handler:function(t,e){this.$refs["formValidate"].resetFields()},deep:!0}},data:function(){return{shipType:[{key:1,title:"手动填写"},{key:2,title:"电子面单打印"}],radioList:[{key:1,title:"发货"},{key:2,title:"送货"},{key:3,title:"虚拟"}],ruleInline:{logisticsCode:[{required:!0,message:"请选择快递公司",trigger:"change"}],number:[{required:!0,message:"请填写快递单号",trigger:"change"}],sendName:[{required:!0,message:"请填写寄件人姓名",trigger:"change"}],sendPhone:[{required:!0,message:"请填写寄件人手机",trigger:"change"},{pattern:/^1[3456789]\d{9}$/,message:"手机号码格式不正确",trigger:"blur"}],sendAddress:[{required:!0,message:"请填写寄件人地址",trigger:"change"}],msg:[{required:!0,message:"请填写备注信息",trigger:"change"}]},formValidate:{gender:1,shipStatus:1,logisticsCode:"",logisticsName:"",number:"",electronic:"",sendName:"",sendPhone:"",sendAddress:"",postPeople:"",msg:""},logisticsList:[],orderTempList:[],deliveryList:[]}},mounted:function(){this.getOrderExport(),this.getDelivery()},methods:{getDelivery:function(){var t=this;Object(I["q"])().then((function(e){t.deliveryList=e.data}))},inited:function(t){this.$viewer=t},getOrderExport:function(t){var e=this;Object(I["s"])(t||"").then((function(t){e.logisticsList=t.data}))},handleSubmit:function(t){var e=this;if(1==this.formValidate.gender&&this.$refs[t].validate((function(t){var s={};s.type=e.formValidate.gender,s.express_record_type=parseFloat(e.formValidate.shipStatus),s.delivery_name=e.formValidate.logisticsName,s.delivery_code=e.formValidate.logisticsCode,t&&(1==e.formValidate.gender&&1==e.formValidate.shipStatus&&(s.delivery_id=e.formValidate.number),1==e.formValidate.gender&&2==e.formValidate.shipStatus&&(s.to_name=e.formValidate.sendName,s.to_tel=e.formValidate.sendPhone,s.to_addr=e.formValidate.sendAddress,s.express_temp_id=e.formValidate.electronic),Object(I["p"])(e.orderId,s).then((function(t){e.$Message.success(t.msg),e.$emit("ok")})).catch((function(t){e.$Message.error(t.msg)})))})),2==this.formValidate.gender){var s={};this.deliveryList.forEach((function(t,i){t.id==e.formValidate.postPeople&&(s=t)})),Object(I["p"])(this.orderId,{type:this.formValidate.gender,sh_delivery_name:s.wx_name,sh_delivery_id:s.phone,sh_delivery_uid:s.id}).then((function(t){e.$Message.success(t.msg),e.$emit("ok")})).catch((function(t){e.$Message.error(t.msg)}))}3==this.formValidate.gender&&Object(I["p"])(this.orderId,{type:this.formValidate.gender,remark:this.formValidate.msg}).then((function(t){e.$Message.success(t.msg),e.$emit("ok")})).catch((function(t){e.$Message.error(t.msg)}))},close:function(){this.$emit("close")},bindChange:function(t){var e=this;this.formValidate.logisticsName=t.label,2==this.formValidate.shipStatus&&Object(I["x"])({com:t.value}).then((function(t){e.orderTempList=t.data.data}))},lookImg:function(){var t=this;this.formValidate.electronic?this.orderTempList.forEach((function(e,s){e.temp_id==t.formValidate.electronic&&t.$viewer.view(s)})):this.$Message.error("请选择电子面单")}}},D=P,A=(s("6a88"),Object(p["a"])(D,j,E,!1,null,"c5773054",null)),V=A.exports,$=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleInline,inline:""}},[s("FormItem",{staticClass:"form-item",attrs:{label:"备注：",prop:"con","label-position":"right","label-width":100}},[s("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入备注",maxlength:"200",type:"textarea",rows:5,"show-word-limit":""},model:{value:t.formValidate.con,callback:function(e){t.$set(t.formValidate,"con",e)},expression:"formValidate.con"}})],1),s("div",{staticClass:"mask-footer"},[s("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("提交")]),s("Button",{on:{click:t.close}},[t._v("取消")])],1)],1)],1)},N=[];function R(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var U={name:"remarks",props:{remarkId:{type:String,default:""}},data:function(){return R({formValidate:{con:""},ruleInline:{con:[{required:!0,message:"请输入备注信息",trigger:"change"}]}},"formValidate",{con:""})},methods:{handleSubmit:function(t){var e=this;this.$refs[t].validate((function(t){t&&Object(I["w"])({order_id:e.remarkId,remark:e.formValidate.con}).then((function(t){e.$Message.success(t.msg),e.$emit("remarkSuccess")})).catch((function(t){e.$Message.error(t.msg)}))}))},close:function(){this.$emit("close")}}},G=U,z=(s("2e98"),Object(p["a"])(G,$,N,!1,null,"7e14c815",null)),B=z.exports,H=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"label-wrapper"},[t._l(t.labelList,(function(e,i){return s("div",{key:i,staticClass:"label-box"},[s("div",{staticClass:"title"},[t._v(t._s(e.name))]),s("div",{staticClass:"list"},t._l(e.label,(function(e,i){return s("div",{key:i,staticClass:"label-item",class:{on:e.disabled},on:{click:function(s){return t.selectLabel(e)}}},[t._v(t._s(e.label_name))])})),0)])})),s("div",{staticClass:"footer"},[s("Button",{staticClass:"btns",attrs:{type:"primary"},on:{click:t.subBtn}},[t._v("确定")]),s("Button",{staticClass:"btns",attrs:{type:"primary",ghost:""},on:{click:t.cancel}},[t._v("取消")])],1)],2)},W=[],F={name:"userLabel",props:{uid:{type:String|Number,default:""}},data:function(){return{labelList:[],activeIds:[]}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;Object(I["Q"])(this.uid).then((function(e){e.data.map((function(e){e.label.map((function(e){e.disabled&&t.activeIds.push(e.id)}))})),t.labelList=e.data}))},selectLabel:function(t){if(t.disabled){var e=this.activeIds.indexOf(t.id);this.activeIds.splice(e,1),t.disabled=!1}else this.activeIds.push(t.id),t.disabled=!0},subBtn:function(){var t=this,e=[];this.labelList.map((function(t){t.label.map((function(t){0==t.disabled&&e.push(t.id)}))})),Object(I["R"])(this.uid,{label_ids:this.activeIds,un_label_ids:e}).then((function(e){t.$Message.success(e.msg),t.$emit("editLabel")})).catch((function(e){t.$Message.error(e.msg)}))},cancel:function(){this.$emit("close")}}},Z=F,Y=(s("9191"),Object(p["a"])(Z,H,W,!1,null,"2e758861",null)),J=Y.exports;function X(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var q={name:"rightMenu",components:{delivery:V,remarks:B,userLabel:J,empty:w["a"]},props:{isTourist:{type:String|Number,default:0},status:{type:String|Number,default:""},uid:{type:String|Number,default:""},webType:{type:String|Number,default:""},exportOpen:{type:String,default:"0"}},filters:{statusFilters:function(t){var e=X({"-1":"申请退款","-2":"退货成功",0:"待发货",1:"待收货",2:"已收货",3:"待评价"},"-1","已退款");return e[t]},getDay:function(t){if(t)return k.a.unix(t).format("YYYY年M月D日")},typeFilters:function(t){var e={h5:"H5",wechat:"公众号",routine:"小程序",pc:"PC"};return e[t]}},data:function(){return{userGroup:[],model1:"",curMenuIndex:0,menuList:[{key:"",title:"全部"},{key:0,title:"未支付"},{key:1,title:"未发货"},{key:-1,title:"退款中"}],activeUserInfo:"",curStatus:this.status,limit:10,orderConfig:{page:1,type:"",searchTxt:""},orderList:[],isOrderScroll:!0,isOrderHidden:!0,isDelivery:!1,isRemarks:!1,goodsTab:[{key:0,title:"购买"},{key:1,title:"足迹"},{key:2,title:"热销"}],goodsConfig:{type:0,buyList:[]},isUserLabel:!1,remarkId:"",orderId:"",storeName:""}},watch:{uid:function(t,e){t!=e&&0==this.isTourist&&t?(this.orderConfig.page=1,this.isOrderScroll=!0,this.orderList=[],Promise.all[(this.getUserInfo(),this.getOrderList(),this.productCart(),this.getUserGroup())],0==this.goodsConfig.type?this.productCart():1==this.goodsConfig.type?this.productVisit():this.productHot()):(this.orderConfig.page=1,this.isOrderScroll=!0,this.orderList=[],this.activeUserInfo="")},isTourist:function(t,e){1==t&&(this.activeUserInfo="",this.orderList=[],this.goodsConfig.buyList=[])}},mounted:function(){var t=this;this.bus.$on("selectRightMenu",(function(e){t.curStatus=e})),this.uid&&0==this.isTourist&&Promise.all[(this.getUserInfo(),this.getOrderList(),this.productCart(),this.getUserGroup())]},methods:{onChange:function(t){var e=this;t&&Object(I["E"])(this.uid,t).then((function(t){e.$Message.success(t.msg)}))},getUserGroup:function(){var t=this;Object(I["O"])().then((function(e){t.userGroup=e.data}))},openDelivery:function(t){this.orderId=t.id,this.isDelivery=!0},deliveryOk:function(){this.orderConfig.page=1,this.isOrderScroll=!0,this.orderList=[],this.getOrderList(),this.isDelivery=!1},bindRemark:function(t){this.remarkId=t.order_id,this.isRemarks=!0},remarkSuccess:function(){this.remarkId="",this.isRemarks=!1},getUserInfo:function(){var t=this;Object(I["P"])(this.uid).then((function(e){t.activeUserInfo=e.data})).catch((function(e){t.activeUserInfo=""}))},getOrderList:function(){var t=this;this.isOrderScroll&&Object(I["n"])(this.uid,{page:this.orderConfig.page,limit:this.limit,type:this.orderConfig.type,search:this.orderConfig.searchTxt}).then((function(e){t.orderConfig.page+=1,t.isOrderScroll=e.data.length>=t.limit,t.orderList=t.orderList.concat(e.data)}))},bindTab:function(t){this.orderConfig.type!==t.key&&(this.orderConfig.type=t.key,this.uid&&(this.orderConfig.page=1,this.isOrderScroll=!0,this.orderList=[],this.getOrderList()))},orderSearch:function(){this.isOrderScroll=!0,this.orderList=[],this.orderConfig.page=1,this.getOrderList()},deliveryClose:function(){this.isUserLabel=!1,this.isDelivery=!1,this.isRemarks=!1},orderEdit:function(t){var e=this;this.$modalForm(Object(I["r"])(t)).then((function(){return e.getOrderList()}))},orderRecord:function(t){var e=this;this.$modalForm(Object(I["u"])(t)).then((function(){return e.getOrderList()}))},orderReachBottom:function(){this.getOrderList()},bindGoodsTab:function(t){this.goodsConfig.type!=t.key&&(this.goodsConfig.type=t.key,""!=this.uid&&(0==t.key?this.productCart():1==t.key?this.productVisit():this.productHot()))},productCart:function(){var t=this;Object(I["A"])(this.uid,{store_name:this.storeName}).then((function(e){t.goodsConfig.buyList=e.data}))},productVisit:function(){var t=this;Object(I["D"])(this.uid,{store_name:this.storeName}).then((function(e){t.goodsConfig.buyList=e.data}))},productHot:function(){var t=this;Object(I["B"])(this.uid,{store_name:this.storeName}).then((function(e){t.goodsConfig.buyList=e.data}))},editLabel:function(){this.isUserLabel=!1,this.getUserInfo()},pushGoods:function(t){this.$emit("bindPush",t.id)},productSearch:function(){0==this.goodsConfig.type?this.productCart():1==this.goodsConfig.type?this.productVisit():this.productHot()}}},K=q,Q=(s("2d97"),Object(p["a"])(K,T,M,!1,null,"19dff9fa",null)),tt=Q.exports,et=s("7624"),st=s("c276"),it=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"msg-box"},[s("div",{staticClass:"head"},[s("div",{staticClass:"tab-bar"},t._l(t.tabList,(function(e,i){return s("a",{key:i,staticClass:"tab-item",class:{on:e.key==t.tabCur},attrs:{href:"javascript:;"},on:{click:function(s){return t.bindTab(e)}}},[t._v(t._s(e.title))])})),0),s("div",{staticClass:"search-box"},[s("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"搜索快捷回复"},on:{"on-enter":t.bindSearch},model:{value:t.searchTxt,callback:function(e){t.searchTxt=e},expression:"searchTxt"}},[s("Icon",{attrs:{slot:"suffix",type:"ios-search"},slot:"suffix"})],1)],1)]),s("div",{staticClass:"main"},[s("div",{staticClass:"left-box"},[s("vue-scroll",{attrs:{ops:t.ops}},[t.tabCur?s("div",{staticClass:"left-item"},[s("p",[t._v("分组")]),s("span",{staticClass:"iconfont iconaddto",on:{click:t.openAddSort}})]):t._e(),t._l(t.sortList,(function(e,i){return s("div",{key:i,staticClass:"left-item",class:{on:t.cateId==e.id},on:{click:function(s){return t.selectSort(e)}}},[s("p",[t._v(t._s(e.name))]),t.tabCur?[s("span",{staticClass:"iconfont iconDot",on:{click:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"top",void 0,s.key,void 0)?null:t.bindEdit(e,i)}}}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"item.isEdit"}],staticClass:"edit-wrapper"},[s("div",{staticClass:"edit-item",on:{click:function(s){return t.editSort(e)}}},[t._v("编辑")]),s("div",{staticClass:"edit-item",on:{click:function(s){return t.delSort(e,"删除分类",i)}}},[t._v("\n                删除\n              ")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"item.isEdit"}],staticClass:"edit-bg",on:{click:function(t){t.stopPropagation(),e.isEdit=!1}}})]:t._e()],2)}))],2)],1),s("div",{staticClass:"right-box"},[s("Scroll",{staticClass:"right-scroll",attrs:{"on-reach-bottom":t.handleReachBottom,height:"360"}},[t.tabCur?s("div",{staticClass:"msg-item add-box",staticStyle:{"margin-top":"0"}},[s("div",{staticClass:"box2"},[s("Input",{staticClass:"input-box",staticStyle:{width:"100%"},attrs:{placeholder:"输入标题（选填）"},on:{"on-focus":t.bindFocus},model:{value:t.addMsg.title,callback:function(e){t.$set(t.addMsg,"title",e)},expression:"addMsg.title"}}),s("div",{staticClass:"conBox",class:{active:t.addMsg.isEdit}},[s("div",{staticClass:"content"},[s("Input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},model:{value:t.addMsg.message,callback:function(e){t.$set(t.addMsg,"message",e)},expression:"addMsg.message"}})],1),s("div",{staticClass:"bom"},[s("div",{staticClass:"select"},[s("Select",{staticStyle:{width:"100px"},attrs:{size:"small"},model:{value:t.addMsg.cateId,callback:function(e){t.$set(t.addMsg,"cateId",e)},expression:"addMsg.cateId"}},t._l(t.sortList,(function(e){return s("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name)+"\n                    ")])})),1)],1),s("div",{staticClass:"btns-box"},[s("Button",{on:{click:function(e){e.stopPropagation(),t.addMsg.isEdit=!1}}},[t._v("取消")]),s("Button",{attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.bindAdd(e)}}},[t._v("保存")])],1)])])],1)]):t._e(),t._l(t.list,(function(e,i){return e.id?s("div",{key:i,staticClass:"msg-item"},[e.isEdit?s("div",{staticClass:"box2"},[s("Input",{staticClass:"input-box",staticStyle:{width:"100%"},attrs:{placeholder:"输入标题（选填）"},model:{value:e.title,callback:function(s){t.$set(e,"title",s)},expression:"item.title"}}),s("div",{staticClass:"content"},[s("Input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},model:{value:e.message,callback:function(s){t.$set(e,"message",s)},expression:"item.message"}})],1),s("div",{staticClass:"bom"},[s("div",{staticClass:"select"},[s("Select",{staticStyle:{width:"100px"},attrs:{size:"small"},model:{value:t.cateId,callback:function(e){t.cateId=e},expression:"cateId"}},t._l(t.sortList,(function(e){return s("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name)+"\n                  ")])})),1)],1),s("div",{staticClass:"btns-box"},[s("Button",{on:{click:function(s){return s.stopPropagation(),t.editClose(e)}}},[t._v("取消")]),s("Button",{attrs:{type:"primary"},on:{click:function(s){return s.stopPropagation(),t.updataMsg(e)}}},[t._v("保存")])],1)])],1):s("div",{staticClass:"box1"},[s("div",{staticClass:"txt-box",on:{click:function(s){return t.bindRadio(e)}}},[e.title?s("span",{staticClass:"title"},[t._v(t._s(t._f("filtersTitle")(e.title)))]):t._e(),e.message?s("span",[t._v(t._s(t._f("filtersCon")(e.message)))]):t._e()]),t.tabCur?s("div",{staticClass:"edit-box"},[s("span",{staticClass:"iconfont iconbianji",on:{click:function(s){return s.stopPropagation(),t.editMsg(e)}}}),s("span",{staticClass:"iconfont iconshanchu",on:{click:function(s){return s.stopPropagation(),t.delMsg(e,"删除话术",i)}}})]):t._e()])]):t._e()}))],2)],1)]),s("Modal",{staticClass:"class-box",attrs:{title:t.maskTitle,width:"304",mask:!1,"footer-hide":!0},model:{value:t.isAddSort,callback:function(e){t.isAddSort=e},expression:"isAddSort"}},[s("div",{staticClass:"item"},[s("span",[t._v("分组名称：")]),s("Input",{attrs:{placeholder:"分组名称"},model:{value:t.classTitle,callback:function(e){t.classTitle=e},expression:"classTitle"}})],1),s("div",{staticClass:"item"},[s("span",[t._v("分组排序：")]),s("Input",{attrs:{placeholder:"输入排序"},model:{value:t.classSort,callback:function(e){t.classSort=e},expression:"classSort"}})],1),s("div",{staticClass:"btn"},[s("Button",{staticStyle:{background:"#1890ff",width:"100%"},attrs:{type:"primary"},on:{click:t.addServiceCate}},[t._v("确定")])],1)])],1)},at=[],nt={name:"msgWindow",data:function(){return{ops:{vuescroll:{mode:"native",enable:!1,tips:{deactive:"Push to Load",active:"Release to Load",start:"Loading...",beforeDeactive:"Load Successfully!"},auto:!1,autoLoadDistance:0,pullRefresh:{enable:!1},pushLoad:{enable:!1,auto:!0,autoLoadDistance:10}},bar:{background:"#393232",opacity:".5",size:"2px"}},isScroll:!0,page:1,limit:10,tabCur:1,tabList:[{title:"个人库",key:1},{title:"公共库",key:0}],searchTxt:"",list:[{isEdit:!1}],model1:"",msgTitle:"",sortList:[],cateId:"",addMsg:{title:"",message:"",cateId:"",isEdit:!1},isAddSort:!1,classTitle:"",classSort:"",maskTitle:"",editObj:{},isSearchType:!1,oldTitle:"",oldMsg:""}},filters:{filtersTitle:function(t){var e=37;if(t.length>e){var s=t.substring(0,e);return"".concat(s,"...")}return t},filtersCon:function(t){var e=113;if(t.length>e){var s=t.substring(0,e);return"".concat(s,"...")}return t}},mounted:function(){var t=this;this.serviceCate(),this.$nextTick((function(){t.scroll=new BScroll(t.$refs.wrapper,{mouseWheel:{speed:20,invert:!1,easeTime:300},scrollbar:!0,disableMouse:!0})}))},methods:{editClose:function(t){this.oldTitle&&this.oldMsg&&(t.title=this.oldTitle,t.message=this.oldMsg),t.isEdit=!1},editMsg:function(t){this.oldTitle=JSON.parse(JSON.stringify(t.title)),this.oldMsg=JSON.parse(JSON.stringify(t.message)),t.isEdit=!0,this.cateId=t.cate_id},bindEdit:function(t,e){0!=e&&(t.isEdit=!t.isEdit)},bindTab:function(t){this.tabCur=t.key,this.cateId="",this.sortList=[],this.isScroll=!0,this.page=1,this.list=[],this.serviceCate()},bindSearch:function(){this.isSearchType||(this.isScroll=!0,this.page=1,this.list=[],this.getList(),this.isSearchType=!0)},selectSort:function(t){this.cateId!=t.id&&(this.sortList.forEach((function(e,s){e.id!=t.id&&(e.isEdit=!1)})),this.cateId=t.id,this.isScroll=!0,this.page=1,this.list=[],this.getList())},delSort:function(t,e,s){var i=this,a={title:e,num:s,url:"/service/cate/".concat(t.id),method:"DELETE",ids:"",kefu:!0};this.$modalSure(a).then((function(t){i.$Message.success(t.msg),i.isScroll=!0,i.page=1,i.list=[],i.cateId="",i.serviceCate()})).catch((function(t){i.$Message.error(t.msg)}))},serviceCate:function(){var t=this;Object(I["H"])({type:this.tabCur}).then((function(e){var s={id:"",name:"全部"};e.data.data.forEach((function(t,e){t.isEdit=!1})),e.data.data.unshift(s),t.sortList=e.data.data,""===t.cateId&&(t.cateId=e.data.data[0].id),t.getList()}))},getList:function(){var t=this;this.isScroll&&Object(I["M"])({page:this.page,limit:this.limit,title:this.searchTxt,cate_id:this.cateId,type:this.tabCur}).then((function(e){t.isScroll=e.data.length>=t.limit,e.data.forEach((function(t,e){t.isEdit=!1})),t.page++,t.list=t.list.concat(e.data),t.isSearchType=!1})).catch((function(e){t.isSearchType=!1}))},updataMsg:function(t){var e=this;Object(I["I"])(t.id,{title:t.title,cate_id:this.cateId,message:t.message}).then((function(s){e.$Message.success("修改成功"),t.isEdit=!1})).catch((function(s){e.$Message.error(s.msg),t.isEdit=!0}))},bindFocus:function(){this.list.forEach((function(t,e){t.isEdit=!1})),this.addMsg.isEdit=!0},openAddSort:function(){console.log("tianj"),this.editObj.id="",this.isAddSort=!0,this.maskTitle="添加分组"},bindAdd:function(){var t=this;Object(I["d"])({title:this.addMsg.title,cate_id:this.addMsg.cateId,message:this.addMsg.message}).then((function(e){t.addMsg.title="",t.addMsg.message="",t.addMsg.cateId="",t.addMsg.isEdit=!1,t.$Message.success(e.msg),e.data.isEdit=!1,t.page=1,t.list=[],t.isScroll=!0,t.serviceCate()})).catch((function(e){t.$Message.error(e.msg)}))},delMsg:function(t,e,s,i){var a=this,n={title:e,num:s,url:"service/speechcraft/".concat(t.id),method:"DELETE",ids:"",kefu:!0};this.$modalSure(n).then((function(t){a.$Message.success(t.msg),a.list.splice(s,1)})).catch((function(t){a.$Message.error(t.msg)}))},addServiceCate:function(){var t=this;this.editObj.id?Object(I["g"])(this.editObj.id,{name:this.classTitle,sort:this.classSort}).then((function(e){t.classTitle="",t.classSort="",t.$Message.success(e.msg),t.isAddSort=!1,t.page=1,t.list=[],t.isScroll=!0,t.serviceCate()})).catch((function(e){t.classTitle="",t.classSort="",t.$Message.error(res.msg)})):Object(I["c"])({name:this.classTitle,sort:this.classSort}).then((function(e){t.classTitle="",t.classSort="",t.$Message.success(e.msg),t.isAddSort=!1,t.page=1,t.list=[],t.isScroll=!0,t.serviceCate()})).catch((function(e){t.classTitle="",t.classSort="",t.$Message.error(res.msg)}))},editSort:function(t){this.classSort=t.sort,this.classTitle=t.name,this.isAddSort=!0,this.maskTitle="编辑分组",this.editObj=t},handleReachBottom:function(){this.getList()},bindRadio:function(t){this.$emit("activeTxt",t.message)}}},ot=nt,rt=(s("8cfd"),s("6db9"),Object(p["a"])(ot,it,at,!1,null,"4d9391cc",null)),ct=rt.exports,lt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"list-wrapper"},t._l(t.labelLists,(function(e,i){return s("div",{key:i,staticClass:"user-item",on:{click:function(s){return t.bindActive(e)}}},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.avatar,expression:"item.avatar"}],attrs:{alt:""}}),s("p",{staticClass:"line1"},[t._v(t._s(e.wx_name))])])})),0)])},dt=[],ut={name:"transfer",props:{userUid:{type:String|Number,default:""}},data:function(){return{loading:!1,currentChoose:"",labelLists:[],name:""}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;Object(I["N"])({nickname:this.name,uid:this.userUid}).then((function(e){t.labelLists=e.data.list}))},bindActive:function(t){var e=this;if(""==this.userUid)return this.$Message.error("转接失败");Object(I["L"])({uid:this.userUid,kefuToUid:t.uid}).then((function(t){e.$Message.success(t.msg),e.$emit("close")})).catch((function(t){e.$Message.error(t.msg)}))}}},mt=ut,ft=(s("b54a5"),Object(p["a"])(mt,lt,dt,!1,null,"1f301970",null)),ht=ft.exports,pt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"goods_detail"},[i("div",{staticClass:"goods_detail_wrapper",staticStyle:{height:"640px"}},[i("HappyScroll",{attrs:{size:"5",resize:"","hide-horizontal":""}},[i("div",{staticStyle:{width:"375px"}},[i("div",{staticClass:"title-box"},[t._v("商品详情")]),i("div",{staticClass:"swiper-box"},[i("Carousel",{attrs:{autoplay:"",loop:"",arrow:"never"},model:{value:t.value2,callback:function(e){t.value2=e},expression:"value2"}},t._l(t.goodsInfo.slider_image,(function(t,e){return i("CarouselItem",{key:e},[i("div",{staticClass:"demo-carousel"},[i("img",{attrs:{src:t,alt:""}})])])})),1)],1),i("div",{staticClass:"goods_info"},[i("div",{staticClass:"number-wrapper"},[i("div",{staticClass:"price"},[i("span",[t._v("¥")]),t._v(t._s(t.goodsInfo.price))]),t.goodsInfo.vip_price>0?i("div",{staticClass:"old-price"},[t._v("\n              ¥"+t._s(t.goodsInfo.vip_price)+"\n              "),i("img",{attrs:{src:s("a254"),alt:"",width:"28"}})]):t._e()]),i("div",{staticClass:"name"},[t._v(t._s(t.goodsInfo.store_name))]),i("div",{staticClass:"msg"},[i("div",{staticClass:"item"},[t._v("原价:￥"+t._s(t.goodsInfo.ot_price))]),i("div",{staticClass:"item"},[t._v("销量:"+t._s(t.goodsInfo.sales))]),i("div",{staticClass:"item"},[t._v("库存:"+t._s(t.goodsInfo.stock))])])]),i("div",{staticClass:"con-box"},[i("div",{staticClass:"title-box"},[t._v("商品介绍")]),i("div",{staticClass:"content",domProps:{innerHTML:t._s(t.goodsInfo.description)}})])])])],1)])},vt=[],gt={name:"goods_detail",props:{goodsId:{type:String|Number,default:""}},components:{HappyScroll:o["HappyScroll"]},data:function(){return{value2:0,goodsInfo:{}}},mounted:function(){this.getInfo()},methods:{getInfo:function(){var t=this;Object(I["C"])(this.goodsId).then((function(e){t.goodsInfo=e.data}))}}},_t=gt,bt=(s("8978"),Object(p["a"])(_t,pt,vt,!1,null,"48b6441f",null)),Ct=bt.exports,yt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.orderDetail.userInfo?s("div",{staticClass:"order_detail"},[s("div",{staticClass:"msg-box"},[s("div",{staticClass:"box-title"},[t._v("收货信息")]),s("div",{staticClass:"msg-wrapper"},[s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("用户昵称：")]),t._v(t._s(t.orderDetail.userInfo.nickname)+"\n                ")]),s("div",{staticClass:"item"},[s("span",[t._v("收货人：")]),t._v(t._s(t.orderDetail.orderInfo.real_name)+"\n                ")])]),s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("联系电话：")]),t._v(t._s(t.orderDetail.orderInfo.user_phone)+"\n                ")]),s("div",{staticClass:"item"},[s("span",[t._v("收货地址：")]),t._v(t._s(t.orderDetail.orderInfo.user_address)+"\n                ")])])])]),s("div",{staticClass:"msg-box",staticStyle:{border:"none"}},[s("div",{staticClass:"box-title"},[t._v("订单信息")]),s("div",{staticClass:"msg-wrapper"},[s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("订单ID：")]),t._v(t._s(t.orderDetail.orderInfo.order_id)+"\n                ")]),s("div",{staticClass:"item",staticStyle:{color:"red"}},[s("span",{staticStyle:{color:"red"}},[t._v("订单状态：")]),t._v(t._s(t.orderDetail.orderInfo._status._title)+"\n                ")])]),s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("商品总数：")]),t._v(t._s(t.orderDetail.orderInfo.total_num)+"\n                ")]),s("div",{staticClass:"item"},[s("span",[t._v("商品总价：")]),t._v(t._s(t.orderDetail.orderInfo.total_price)+"\n                ")])]),s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("交付邮费：")]),t._v(t._s(t.orderDetail.orderInfo.pay_postage)+"\n                ")]),s("div",{staticClass:"item"},[s("span",[t._v("优惠券金额：")]),t._v(t._s(t.orderDetail.orderInfo.coupon_price)+"\n                ")])]),s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("实际支付：")]),t._v(t._s(t.orderDetail.orderInfo.pay_price)+"\n                ")]),s("div",{staticClass:"item"},[s("span",[t._v("创建时间：")]),t._v(t._s(t.orderDetail.orderInfo.add_time)+"\n                ")])]),s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("支付方式：")]),t._v(t._s(t.orderDetail.orderInfo._status._payType)+"\n                ")]),s("div",{staticClass:"item"},[s("span",[t._v("推广人：")]),t._v(t._s(t.orderDetail.userInfo.spread_name)+"\n                ")])]),s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("商家备注：")]),t._v(t._s(t.orderDetail.orderInfo.remark)+"\n                ")])])])]),s("div",{staticClass:"goods-box"},[s("Table",{attrs:{columns:t.columns1,data:t.orderList},scopedSlots:t._u([{key:"id",fn:function(e){var s=e.row;e.index;return[t._v("\n                "+t._s(s.productInfo.id)+"\n            ")]}},{key:"name",fn:function(e){var i=e.row;e.index;return[s("div",{staticClass:"product_info"},[s("img",{attrs:{src:i.productInfo.image,alt:""}}),s("p",[t._v(t._s(i.productInfo.store_name))])])]}},{key:"className",fn:function(e){var s=e.row;e.index;return[t._v("\n                "+t._s(s.class_name)+"\n            ")]}},{key:"price",fn:function(e){var s=e.row;e.index;return[t._v("\n                "+t._s(s.productInfo.attrInfo.price)+"\n            ")]}},{key:"total_num",fn:function(e){var s=e.row;e.index;return[t._v("\n                "+t._s(s.cart_num)+"\n            ")]}}],null,!1,226010347)})],1)]):t._e()},kt=[],It={name:"order_detail",props:{orderId:{type:String|Number,default:""}},data:function(){return{orderDetail:{},orderList:[],columns1:[{title:"商品ID",slot:"id",maxWidth:80},{title:"商品名称",slot:"name",minWidth:160},{title:"商品分类",slot:"className"},{title:"商品售价",slot:"price"},{title:"商品数量",slot:"total_num"}]}},mounted:function(){this.getOrderInfo()},methods:{getOrderInfo:function(){var t=this;Object(I["t"])(this.orderId).then((function(e){e.data.orderInfo.add_time=t.$moment(1e3*parseInt(e.data.orderInfo.add_time)).format("YYYY-MM-DD"),t.orderDetail=e.data,t.orderList=e.data.orderInfo.cartInfo}))}}},wt=It,xt=(s("ed34"),Object(p["a"])(wt,yt,kt,!1,null,"2044fb2f",null)),St=xt.exports,Ot=s("7a1a");function Lt(t){return jt(t)||Mt(t)||Tt()}function Tt(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Mt(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function jt(t){if(Array.isArray(t)){for(var e=0,s=new Array(t.length);e<t.length;e++)s[e]=t[e];return s}}function Et(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function Pt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Et(s,!0).forEach((function(e){Dt(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Et(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function Dt(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var At=s("16b0"),Vt=new Audio(At),$t=function(t,e){e=1*e||1;var s=[];return t.forEach((function(t,i){i%e===0&&s.push([]),s[s.length-1].push(t)})),s},Nt={name:"index",components:{baseHeader:g,chatList:L,rightMenu:tt,msgWindow:ct,transfer:ht,HappyScroll:o["HappyScroll"],goodsDetail:Ct,orderDetail:St},data:function(){return{isEmoji:!1,chatCon:"",emojiGroup:$t(et["a"],20),emojiList:et["a"],html:"",userActive:{},kefuInfo:{},isMsg:!1,isTransfer:!1,activeMsg:"",chatList:[],text:"",limit:20,upperId:0,online:!0,scrollTop:0,isScroll:!0,oldHeight:0,isLoad:!1,isProductBox:!1,goodsId:"",isOrder:!1,orderId:"",upload:"",header:{},uploadData:{filename:"file"},userOnline:{},newRecored:{},searchData:"",scrollNum:0,transferId:"",bodyClose:!1,tourist:0,pageWs:"",isShow:!1}},computed:Pt({},Object(l["e"])({socketStatus:function(t){return t.admin.kefu.socketStatus}}),{disabled:function(){return 0==this.chatCon.length},records:function(){var t=this;return this.chatList.map((function(e,s){return e.time=t.$moment(1e3*e.add_time).format("MMMDo H:mm"),s?e.add_time-t.chatList[s-1].add_time>=300?e.show=!0:e.show=!1:e.show=!0,e}))}}),watch:{},created:function(){var t=this;this.upload=n["a"].apiBaseURL.replace("adminapi","kefuapi")+"/upload",Object(Ot["a"])().then((function(e){t.kefuInfo=e.data,t.kefuInfo.site_name?document.title=t.kefuInfo.site_name:t.kefuInfo.site_name=""}))},mounted:function(){var t=this;window.addEventListener("click",(function(){t.isEmoji=!1})),this.bus.pageWs=Object(C["a"])(!0,st["a"].cookies.kefuGet("token")),this.wsAgain(),this.header["Authori-zation"]="Bearer "+st["a"].cookies.kefuGet("token"),this.text=this.replace_em("[em-smiling_imp]")},methods:{wsAgain:function(){var t=this;this.bus.pageWs.then((function(e){e.$on(["reply","chat"],(function(e){1==e.msn_type&&(e.msn=t.replace_em(e.msn)),2==e.msn_type&&-1==e.msn.indexOf("[")&&(e.msn=t.replace_em("[".concat(e.msn,"]"))),t.chatList.push(e),t.$nextTick((function(){this.scrollTop=document.querySelector("#chat_scroll").offsetHeight}))})),e.$on("reply",(function(t){})),e.$on("socket_error",(function(){t.$Message.error("连接失败")})),e.$on("err_tip",(function(e){t.$Message.error(e.msg)})),e.$on("user_online",(function(e){t.userOnline=e})),e.$on("mssage_num",(function(e){e.num>0&&Vt.play(),t.chatList.forEach((function(t){t.to_uid==e.uid&&(t.mssage_num=e.num)})),e.recored.id&&(t.newRecored=e.recored)})),e.$on("timeout",(function(e){setTimeout((function(){t.isShow=!1,t.wsRestart()}),2e3)})),e.$on("success",(function(e){t.isShow=!0}))})).catch((function(e){setTimeout((function(){t.wsRestart()}),2e3)}))},wsRestart:function(){this.bus.pageWs=Object(C["a"])(!0),this.wsAgain()},handleFormatError:function(t){this.$Message.error("上传图片只能是 jpg、jpg、jpeg、gif 格式!")},bindEnter:function(t){if(""==t.target.value)return this.$Message.error("请输入消息");this.sendMsg(t.target.value,1),this.chatCon=""},handleSuccess:function(t,e,s){200===t.status?(this.$Message.success(t.msg),this.sendMsg(t.data.url,3)):this.$Message.error(t.msg)},lookOrder:function(t){this.orderId=t.orderInfo.id,this.isOrder=!0},setOnline:function(t){this.bus.pageWs.then((function(e){e.send({data:{online:t},type:"online"})})),this.online=t},listen:function(t){if(13==t.keyCode)return t.preventDefault(),!1},select:function(t){var e="[".concat(t,"]");this.chatCon+=e,this.isEmoji=!1},replace_em:function(t){return t=t.replace(/\[em-([a-z_]*)\]/g,"<span class='em em-$1'/></span>"),t},changeType:function(t){this.tourist=t},setDataId:function(t){var e=this;this.userActive=t,this.chatList=[],this.upperId=0,this.oldHeight=0,this.isScroll=!0,t?(window.document.title=t.nickname?"正在和".concat(t.nickname,"对话中 - ").concat(this.kefuInfo.site_name):"正在和游客对话中 - "+this.kefuInfo.site_name,this.bus.pageWs.then((function(t){t.send({data:{id:e.userActive.to_uid},type:"to_chat"})})),this.getChatList(),this.$refs.textBox.focus()):window.document.title=this.kefuInfo.site_name},msgClose:function(){this.isTransfer=!1},activeTxt:function(t){this.chatCon=t,this.isMsg=!1},sendText:function(){this.sendMsg(this.chatCon,1),this.chatCon=""},sendMsg:function(t,e){var s={type:"chat",data:{msn:t,type:e,to_uid:this.userActive.to_uid,is_tourist:this.tourist}};this.bus.pageWs.then((function(t){t.send(s)}))},send:function(t,e){C["a"].send({data:e,type:t})},getChatList:function(){var t=this;Object(I["J"])({limit:this.limit,uid:this.userActive.to_uid,upperId:this.upperId,is_tourist:this.tourist}).then((function(e){e.data.forEach((function(e){1==e.msn_type?e.msn=t.replace_em(e.msn):2==e.msn_type&&(e.msn=t.replace_em("[".concat(e.msn,"]")))}));var s="";s=0==t.upperId?"":"chat_".concat(t.chatList[0].id),t.chatList=[].concat(Lt(e.data),Lt(t.chatList)),t.upperId=e.data.length>0?e.data[0].id:0,t.isLoad=!1,t.$nextTick((function(){t.isScroll=e.data.length>=t.limit,t.setPageScrollTo(s)}))}))},setPageScrollTo:function(t){var e=this;this.$nextTick((function(){if(t)setTimeout((function(){var s=parseFloat(document.getElementById(t).offsetTop)-60;e.scrollTop=s}),0);else{var s=document.querySelector("#chat_scroll");e.scrollTop=s.offsetHeight,setTimeout((function(t){e.scrollTop!=e.$refs.scrollBox.offsetHeight&&(e.scrollTop=document.querySelector("#chat_scroll").offsetHeight)}),300)}}))},scrollHandler:function(){this.isScroll&&this.upperId&&(this.isLoad=!0,this.getChatList())},scrollToTop:function(t){var e=this,s=document.querySelector("#chat_scroll");this.scrollTop=s.offsetHeight-this.oldHeight,setTimeout((function(t){e.scrollTop=e.$refs.scrollBox.offsetHeight-e.oldHeight}),300)},bindPush:function(t){this.sendMsg(t,5)},lookGoods:function(t){this.goodsId=t.msn,this.isProductBox=!0},bindSearch:function(t){this.searchData=t,this.oldHeight=0,this.upperId=0,this.isScroll=!1},transferPeople:function(t){this.transferId=t.id,this.isTransfer=!1,this.$Message.success("转接成功"),this.bus.pageWs.then((function(e){e.send({type:"to_chat",data:{id:t.uid}})}))},transferOk:function(){}}},Rt=Nt,Ut=(s("0820"),Object(p["a"])(Rt,i,a,!1,null,"6e0ef5a2",null));e["default"]=Ut.exports},"3b7a":function(t,e,s){"use strict";var i=s("7352"),a=s.n(i);a.a},5762:function(t,e,s){},"576a":function(t,e,s){},"6a88":function(t,e,s){"use strict";var i=s("5762"),a=s.n(i);a.a},"6db9":function(t,e,s){"use strict";var i=s("576a"),a=s.n(i);a.a},7352:function(t,e,s){},7624:function(t,e,s){"use strict";e["a"]=["em-smile","em-laughing","em-blush","em-smiley","em-relaxed","em-smirk","em-heart_eyes","em-kissing_heart","em-kissing_closed_eyes","em-flushed","em-relieved","em-satisfied","em-grin","em-wink","em-stuck_out_tongue_winking_eye","em-stuck_out_tongue_closed_eyes","em-grinning","em-kissing","em-kissing_smiling_eyes","em-stuck_out_tongue","em-sleeping","em-worried","em-frowning","em-anguished","em-open_mouth","em-grimacing","em-confused","em-hushed","em-expressionless","em-unamused","em-sweat_smile","em-sweat","em-disappointed_relieved","em-weary","em-pensive","em-disappointed","em-confounded","em-fearful","em-cold_sweat","em-persevere","em-cry","em-sob","em-joy","em-astonished","em-scream","em-tired_face","em-angry","em-rage","em-triumph","em-sleepy","em-yum","em-mask","em-sunglasses","em-dizzy_face","em-imp","em-smiling_imp","em-neutral_face","em-no_mouth","em-innocent","em-alien"]},8978:function(t,e,s){"use strict";var i=s("0105"),a=s.n(i);a.a},"8cfd":function(t,e,s){"use strict";var i=s("e530"),a=s.n(i);a.a},9191:function(t,e,s){"use strict";var i=s("eefc"),a=s.n(i);a.a},"9f60":function(t,e,s){},a254:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAAWCAYAAACL6W/rAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFGmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0NDYwLCAyMDIwLzA1LzEyLTE2OjA0OjE3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMiAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjAtMTEtMTBUMTU6MzI6MTkrMDg6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIwLTExLTEwVDE1OjMyOjUxKzA4OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTExLTEwVDE1OjMyOjUxKzA4OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmZlYzBlOWE3LWE4YTEtNGZmNi05Nzg1LTkwMTViNmJjNzE5OCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpmZWMwZTlhNy1hOGExLTRmZjYtOTc4NS05MDE1YjZiYzcxOTgiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpmZWMwZTlhNy1hOGExLTRmZjYtOTc4NS05MDE1YjZiYzcxOTgiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmZlYzBlOWE3LWE4YTEtNGZmNi05Nzg1LTkwMTViNmJjNzE5OCIgc3RFdnQ6d2hlbj0iMjAyMC0xMS0xMFQxNTozMjoxOSswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjIgKE1hY2ludG9zaCkiLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+iB4NtgAABDpJREFUWIXdln1MlVUcxz/neR7QIEYi6VSYqLTSZjgvQi4VtFSwWUSytmaa1h8tw8ra/KuXLVtb/9RmU1ZLcxMr04q8LRlxezFIq2uxgZCvpMQ7oSYvl+c55/THxa53PBCXcGx+/7l7zvmd3/l+f2/nCq016enpu4HHuYFg9P9uAk6MJZHRhgHg9/u7LcsqALrHmM+o4WrGOHbs2Ang6THkMqowrv3w+/17gA/GhsrownJZ2wRkAHOGOhgbA6vvldwxS3FLnKa906DmlMDrM7HtoM3DOZJAn8DrMwb1s3C+Yk6qYvcBiyUZivg4TUmZCcCqpZKpk3SYvSMFzW1QfdKgoUkMX5jf7+/OzMwscBynZrBDqSmKom19aC2oOWnQ3G4w/05J3nLNhjUOG7eOo/0vSJqiKci18f04nu4ed1/Pb7Rp7RC8vx+W3i2ZPi0kbPUyyW0zFKfrQ4GJjwverxR8eMjk7V1RwxMGwX7zeDyDRmPbFpva0ybPvRaFlCFXM5I1xW8FeGWzTeGrUXh9Jo/lOSxbqFyzdvtMzcxkza5PXGkAUFVr8MLr0WFrE+I1G9ZI1j7ocLza5PufBvoevEYGwU3jYdZ0TXmlcY2oIM5dEBz4yiIjTRIbA2f+ENSdFeRmO66+crMlXT3w7VEzIg6dlwTvfWwS6IP0ucrVJmJhPb3Q0i5YvkgSHT1wf2exxfoXx+H0i/b6TBbcpUhMCLcTAlYulpRXmvQGImUBV7oEFy8LYmO0637EwgDe2BnFvNmK/dsDPPmIQ2pKKGo9vVB3RhDoJ3v4OxOlYMXi8PSmz1XcmqDx+iLL1lVkpCkmJ2rOnHeXMHhxD4GKXwwKnhnHA/dJcrIUTz3qcKFJ8HWFyaelJk2toWl18bKg8rjJqmzJvpKQiNxsSWOr4Hj10LGdnAg5WaHARUdpkqdo8lZIGpoNPit1D8yIhAE0tgiKii2KiiElSZGVqbl/qcO6fIdt70RxqDx0oddn8OZWm5QkTX2DIDoali2UfOT97+tnJCkK19n/ftsONLcJDh42KS4x6el1PxexsNgYiI/TNLaEslLfYFDfAHsOmmx5wuHlzTY1pwzOng/aHPnZ5NLfNjlZkqJiiyULFDfHMKwyPPrbwKk4HETcY2mzFV+8GyB5qnvT7thrIqUIm1a2DWUVFrlZwT7LyXKoqhv6gf2/iFhYVa2BVPDQCum6P3ECWKamvTN83eszmTZZsyhdco9HjXhoDBcRl2JXN2zfY/HsBgfDCBJu7RCkTFPMm6PIXyk512Bw9Ndw4tW/C+r/FLxU6KAUlP0wooE8bIxoeOz93MKRsD4/+Ppfhe1A6RGTHXst179QX35jsmmtQ1mFyZWu61eGAEJrjRADL/F4PO5NdO1hAYkJmkkT4fKV4MPd13ddeEaMEY97AK2hrUPQ1jFadEYP17fQxxA3rLB/AInulg8syJa/AAAAAElFTkSuQmCC"},b1f9:function(t,e,s){},b2d4:function(t,e,s){"use strict";var i=s("e08c"),a=s.n(i);a.a},b54a5:function(t,e,s){"use strict";var i=s("9f60"),a=s.n(i);a.a},e08c:function(t,e,s){},e530:function(t,e,s){},ed34:function(t,e,s){"use strict";var i=s("2ba2"),a=s.n(i);a.a},eefc:function(t,e,s){},fce9:function(t,e,s){}}]);