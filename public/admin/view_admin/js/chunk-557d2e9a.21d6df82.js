(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-557d2e9a"],{"0363":function(t,e,i){"use strict";i("4897")},4897:function(t,e,i){},"6fd3":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Modal",{attrs:{scrollable:"",title:"添加商品规格",width:"950"},on:{"on-cancel":t.onCancel},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[i("Form",{ref:"formDynamic",staticClass:"attrFrom",attrs:{model:t.formDynamic,rules:t.rules,"label-width":t.labelWidth,"label-position":t.labelPosition},nativeOn:{submit:function(t){t.preventDefault()}}},[i("Row",{attrs:{gutter:24}},[i("Col",{attrs:{span:"24"}},[i("Col",{staticClass:"mb15",attrs:{span:"8"}},[i("FormItem",{attrs:{label:"规格模板名称：",prop:"rule_name"}},[i("Input",{attrs:{placeholder:"请输入标题名称",maxlength:20},model:{value:t.formDynamic.rule_name,callback:function(e){t.$set(t.formDynamic,"rule_name",e)},expression:"formDynamic.rule_name"}})],1)],1)],1),t._l(t.formDynamic.spec,(function(e,a){return i("Col",{key:a,staticClass:"noForm",attrs:{span:"23"}},[i("FormItem",[i("div",{staticClass:"acea-row row-middle"},[i("span",{staticClass:"mr5"},[t._v(t._s(e.value))]),i("Icon",{attrs:{type:"ios-close-circle"},on:{click:function(e){return t.handleRemove(a)}}})],1),i("div",{staticClass:"rulesBox"},[t._l(e.detail,(function(a,n){return i("Tag",{key:n,staticClass:"mb5",attrs:{type:"dot",closable:"",color:"primary",name:a},on:{"on-close":function(i){return t.handleRemove2(e.detail,n)}}},[t._v(t._s(a))])})),i("Input",{staticStyle:{width:"150px"},attrs:{search:"","enter-button":"添加",placeholder:"请输入属性名称"},on:{"on-search":function(i){return t.createAttr(e.detail.attrsVal,a)}},model:{value:e.detail.attrsVal,callback:function(i){t.$set(e.detail,"attrsVal",i)},expression:"item.detail.attrsVal"}})],2)])],1)})),t.isBtn?i("Col",{staticClass:"mt10",attrs:{span:"24"}},[i("Col",{staticClass:"mr15",attrs:{span:"8"}},[i("FormItem",{attrs:{label:"规格名称："}},[i("Input",{attrs:{placeholder:"请输入规格"},model:{value:t.attrsName,callback:function(e){t.attrsName=e},expression:"attrsName"}})],1)],1),i("Col",{staticClass:"mr20",attrs:{span:"8"}},[i("FormItem",{attrs:{label:"规格值："}},[i("Input",{attrs:{placeholder:"请输入规格值"},model:{value:t.attrsVal,callback:function(e){t.attrsVal=e},expression:"attrsVal"}})],1)],1),i("Col",{attrs:{span:"2"}},[i("Button",{attrs:{type:"primary"},on:{click:t.createAttrName}},[t._v("确定")])],1),i("Col",{attrs:{span:"2"}},[i("Button",{on:{click:t.offAttrName}},[t._v("取消")])],1)],1):t._e(),t.spinShow?i("Spin",{attrs:{size:"large",fix:""}}):t._e()],2),t.isBtn?t._e():i("Button",{staticClass:"ml95 mt10",attrs:{type:"primary",icon:"md-add"},on:{click:t.addBtn}},[t._v("添加新规格")])],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"primary",loading:t.modal_loading},on:{click:function(e){return t.handleSubmit("formDynamic")}}},[t._v("确定")])],1)],1)},n=[],s=i("7736"),r=i("c4c8");function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){c(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var u={name:"addAttr",data:function(){return{spinShow:!1,modal_loading:!1,grid:{xl:3,lg:3,md:12,sm:24,xs:24},modal:!1,index:1,rules:{rule_name:[{required:!0,message:"请输入规格名称",trigger:"blur"}]},formDynamic:{rule_name:"",spec:[]},attrsName:"",attrsVal:"",formDynamicNameData:[],isBtn:!1,formDynamicName:[],results:[],result:[],ids:0}},computed:l(l({},Object(s["e"])("admin/layout",["isMobile"])),{},{labelWidth:function(){return this.isMobile?void 0:95},labelPosition:function(){return this.isMobile?"top":"right"}}),methods:{onCancel:function(){this.clear()},addBtn:function(){this.isBtn=!0},getIofo:function(t){var e=this;this.spinShow=!0,this.ids=t.id,Object(r["A"])(t.id).then((function(t){e.formDynamic=t.data.info,e.spinShow=!1})).catch((function(t){e.spinShow=!1,e.$Message.error(t.msg)}))},handleSubmit:function(t){var e=this;this.$refs[t].validate((function(t){return!!t&&(0===e.formDynamic.spec.length?e.$Message.warning("请至少添加一条商品规格！"):(e.modal_loading=!0,void setTimeout((function(){Object(r["z"])(e.formDynamic,e.ids).then((function(t){e.$Message.success(t.msg),setTimeout((function(){e.modal=!1,e.modal_loading=!1}),500),setTimeout((function(){e.$emit("getList"),e.clear()}),600)})).catch((function(t){e.modal_loading=!1,e.$Message.error(t.msg)}))}),1200)))}))},clear:function(){this.$refs["formDynamic"].resetFields(),this.formDynamic.spec=[],this.isBtn=!1,this.attrsName="",this.attrsVal=""},offAttrName:function(){this.isBtn=!1},handleRemove:function(t){this.formDynamic.spec.splice(t,1)},handleRemove2:function(t,e){t.splice(e,1)},createAttrName:function(){if(this.attrsName&&this.attrsVal){var t={value:this.attrsName,detail:[this.attrsVal]};this.formDynamic.spec.push(t);var e={};this.formDynamic.spec=this.formDynamic.spec.reduce((function(t,i){return!e[i.value]&&(e[i.value]=t.push(i)),t}),[]),this.attrsName="",this.attrsVal="",this.isBtn=!1}else this.$Message.warning("请添加规格名称或规格值")},createAttr:function(t,e){if(t){this.formDynamic.spec[e].detail.push(t);var i={};this.formDynamic.spec[e].detail=this.formDynamic.spec[e].detail.reduce((function(t,e){return!i[e]&&(i[e]=t.push(e)),t}),[])}else this.$Message.warning("请添加属性")}}},d=u,h=(i("0363"),i("5d22")),m=Object(h["a"])(d,a,n,!1,null,"ac4f1888",null);e["a"]=m.exports},"7f08":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"i-layout-page-header"},[i("PageHeader",{staticClass:"product_tabs",attrs:{title:"商品规格","hidden-breadcrumb":""}})],1),i("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":""}},[i("Form",{ref:"artFrom",staticClass:"tabform",attrs:{model:t.artFrom,"label-width":t.labelWidth,"label-position":t.labelPosition},nativeOn:{submit:function(t){t.preventDefault()}}},[i("Row",{attrs:{gutter:24,type:"flex",justify:"end"}},[i("Col",{staticClass:"ivu-text-left",attrs:{span:"24"}},[i("FormItem",{attrs:{label:"规格搜索："}},[i("Input",{staticStyle:{width:"30%"},attrs:{search:"","enter-button":"",placeholder:"请输入规格名称"},on:{"on-search":t.userSearchs},model:{value:t.artFrom.rule_name,callback:function(e){t.$set(t.artFrom,"rule_name",e)},expression:"artFrom.rule_name"}})],1)],1),i("Col",{attrs:{span:"24"}},[i("Button",{directives:[{name:"auth",rawName:"v-auth",value:["product-rule-save"],expression:"['product-rule-save']"}],staticClass:"mr20",attrs:{type:"primary",icon:"md-add"},on:{click:t.addAttr}},[t._v("添加商品规格")]),i("Tooltip",{attrs:{content:"本页至少选中一项",disabled:!!t.selectionList.length}},[i("Button",{directives:[{name:"auth",rawName:"v-auth",value:["product-product-rule-delete"],expression:"['product-product-rule-delete']"}],attrs:{disabled:!t.selectionList.length},on:{click:function(e){return t.del(null,"批量删除规格")}}},[t._v("批量删除")])],1)],1)],1)],1),i("Table",{ref:"selection",staticClass:"mt25",attrs:{columns:t.columns4,data:t.tableList,loading:t.loading,"highlight-row":"","no-data-text":"暂无数据","no-filtered-data-text":"暂无筛选结果"},on:{"on-selection-change":t.onSelectTab,"on-select-all":t.selectAll,"on-select-all-cancel":t.selectAll},scopedSlots:t._u([{key:"attr_value",fn:function(e){var a=e.row;return t._l(a.attr_value,(function(e,a){return i("span",{key:a,staticStyle:{display:"block"},domProps:{textContent:t._s(e)}})}))}},{key:"action",fn:function(e){var a=e.row;return[i("a",{on:{click:function(e){return t.edit(a)}}},[t._v("编辑")]),i("Divider",{attrs:{type:"vertical"}}),i("a",{on:{click:function(e){return t.del(a,"删除规格")}}},[t._v("删除")])]}}])}),i("div",{staticClass:"acea-row row-right page"},[i("Page",{attrs:{total:t.total,current:t.artFrom.page,"show-elevator":"","show-total":"","page-size":t.artFrom.limit},on:{"on-change":t.pageChange}})],1)],1),i("add-attr",{ref:"addattr",on:{getList:t.userSearchs}})],1)},n=[],s=i("7736"),r=i("6fd3"),o=i("c4c8");function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){u(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var d={name:"productAttr",components:{addAttr:r["a"]},data:function(){var t=this;return{loading:!1,artFrom:{page:1,limit:15,rule_name:""},columns4:[{width:60,align:"center",renderHeader:function(e,i){return e("div",{class:{"select-panel":!0},on:{mouseenter:function(e){t.display="block"},mouseleave:function(e){t.display="none"}}},[e("Checkbox",{props:{value:t.checkBox},on:{"on-change":function(e){t.checkBox=e,t.isAll=e?0:-1,t.$refs.selection.selectAll(t.checkBox)}}}),e("div",{style:{position:"absolute",top:0,zIndex:2,display:t.display,width:"80px",height:"100%",padding:"0px 0",borderRadius:"4px",backgroundColor:"#fff",boxShadow:"0 0px 5px rgba(0, 0, 0, 0.2)",transform:"translateX(25%)"}},[e("div",{class:{"select-item":!0,on:0===t.isAll},style:{padding:"1px 6px",cursor:"pointer",height:"50%"},on:{click:function(e){0===t.isAll?(t.isAll=-1,t.checkBox=!1,t.$refs.selection.selectAll(t.checkBox)):(t.isAll=0,t.selectionList.length||(t.checkBox=!0,t.$refs.selection.selectAll(t.checkBox))),t.display="none"}}},"选择当页"),e("div",{class:{"select-item":!0,on:1===t.isAll},style:{padding:"1px 6px",cursor:"pointer",height:"50%"},on:{click:function(e){1===t.isAll?(t.isAll=-1,t.checkBox=!1):(t.isAll=1,t.checkBox=!0),t.$refs.selection.selectAll(t.checkBox),t.display="none"}}},"选择全部")])])},render:function(e,i){return e("Checkbox",{props:{value:i.row.checkBox},on:{"on-change":function(e){e?t.selectionList.push(i.row):(t.checkBox=!1,t.selectionList.forEach((function(e,a){e.id===i.row.id&&t.selectionList.splice(a,1)}))),t.isAll=t.selectionList.length?0:-1,i.row.checkBox=e,t.tableList[i.index].checkBox=e}},ref:"checkbox",refInFor:!0})}},{title:"ID",key:"id",width:80},{title:"规格名称",key:"rule_name",minWidth:150},{title:"商品规格",key:"attr_name",minWidth:250},{title:"商品属性",slot:"attr_value",minWidth:300},{title:"操作",slot:"action",fixed:"right",minWidth:120}],tableList:[],total:0,ids:"",selectionList:[],selectionCopy:[],display:"none",isAll:0,checkBox:!1}},watch:{tableList:{deep:!0,handler:function(t){var e=this;t.forEach((function(t){e.selectionList.forEach((function(e){e.id===t.id&&(t.checkBox=!0)}))}));var i=this.tableList.filter((function(t){return t.checkBox}));this.tableList.length?this.checkBox=this.tableList.length===i.length:this.checkBox=!1}},selectionList:{deep:!0,handler:function(t){var e=t.map((function(t){return t.id}));this.ids=e.join()}}},computed:c(c(c({},Object(s["e"])("admin/layout",["isMobile"])),Object(s["e"])("admin/order",["orderChartType"])),{},{labelWidth:function(){return this.isMobile?void 0:80},labelPosition:function(){return this.isMobile?"top":"right"}}),created:function(){this.getDataList()},methods:{selectAll:function(t){var e=this;t.length&&(this.selectionList=t,this.selectionCopy=t),this.selectionCopy.forEach((function(t,i){t.checkBox=e.checkBox,e.$set(e.tableList,i,t)}))},onSelectTab:function(t){this.selectionList=t;var e=[];this.selectionList.map((function(t){e.push(t.id)})),this.ids=e.join(",")},del:function(t,e){var i=this,a={};if("批量删除规格"===e){if(0===this.selectionList.length)return this.$Message.warning("请选择要删除的规格！");a={all:this.isAll},0===this.isAll?a.ids=this.ids:1===this.isAll&&(a.where={rule_name:this.artFrom.rule_name})}else a={ids:t.id};var n={title:e,num:0,url:"product/product/rule/delete",method:"DELETE",ids:a};this.$modalSure(n).then((function(t){i.$Message.success(t.msg),i.getDataList()})).catch((function(t){i.$Message.error(t.msg)}))},addAttr:function(){this.$refs.addattr.ids=0,this.$refs.addattr.modal=!0},edit:function(t){this.$refs.addattr.modal=!0,this.$refs.addattr.getIofo(t)},getDataList:function(){var t=this;this.loading=!0,Object(o["B"])(this.artFrom).then((function(e){var i=e.data;t.tableList=i.list.map((function(t){return t.checkBox=!1,t})),t.total=e.data.count,t.loading=!1})).catch((function(e){t.loading=!1,t.$Message.error(e.msg)}))},pageChange:function(t){this.artFrom.page=t,this.getDataList()},userSearchs:function(){this.artFrom.page=1,this.selectionList=[],this.getDataList()}}},h=d,m=(i("f0d0"),i("5d22")),f=Object(m["a"])(h,a,n,!1,null,"09374c63",null);e["default"]=f.exports},"7f6e":function(t,e,i){},f0d0:function(t,e,i){"use strict";i("7f6e")}}]);